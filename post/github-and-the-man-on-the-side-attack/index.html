<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> GitHub and the Man On The Side Attack &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Apr 7, 2015</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 600 words 3 min. read
        </div>
        <h1>GitHub and the Man On The Side Attack</h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">Recently most of the people used to collaborate through <a href="https://github.com/" target="_blank">GitHub</a> experienced a new kind of Denial Of Service Attack widly recognized as <a href="http://en.wikipedia.org/wiki/Man-on-the-side_attack" target="_blank">Main-On-The-Side Attack</a>. The Github DDOS attack was driven by the State of China (<a href="http://www.nytimes.com/2015/03/31/technology/china-appears-to-attack-github-by-diverting-web-traffic.html?_r=0" target="_blank">NewYorkTime</a>) with the intent to alert GitHub company about the violation of the Chinese censorship policies.</div><div style="text-align: justify;"><blockquote class="tr_bq">"Because GitHub is fully encrypted, China’s domestic web filters cannot  distinguish between pages that host code useful to programmers and code  that circumvents censorship." (Source: <a href="http://www.nytimes.com/2015/03/31/technology/china-appears-to-attack-github-by-diverting-web-traffic.html?_r=0" target="_blank">NewYorkTime</a>)</blockquote></div><div style="text-align: justify;">The cyber attack has made possible because the Chinese Government poisoned web traffic throuugh its "great firewall" (Golden Shield Project) injetting a malicious javascript payload into specific http requests.&nbsp; Chinese Government sacrified a local analytics company named Baidu injecting into its analytics scripts a malicious content able to load multiple times the tergeted github pages. A simple attack flow follows:</div><ol style="text-align: justify;"><li>A unaware user is browsing from outside China</li><li>The website the user visits loads a javascript from a server located in China, for example Baidu Analytics script (much like Google Analytics)</li><li>The user web broswet requests for Baidu javascript</li><li>The requested javascript is intercepted by Chinese passive infrastructures as it enter in China perimeter</li><li>A compromised response is sent out from China instead of the actual Baidu Analytics script</li><li>The compromised response tells to the user browser to contnuosly load specific pages on GitHub.com.</li></ol><div style="text-align: justify;">Finding the original malicious code in order to analyze it,&nbsp; was actually the real challenge (at least for me). I've tried to execute tons of Baidu urls GET requests but no malicious payloads were found. Fortunately Urlquery.net saw the code and stored it (<a href="http://urlquery.net/report.php?id=1426672633782" target="_blank">here</a>). The following image shows one of the used payloads (that report proves tha multiple payloads were involved).</div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-hmoYVhYpy4g/VRq9H_psaLI/AAAAAAAAMRU/kWfiCxhJgH4/s1600/Screen%2BShot%2B2015-03-31%2Bat%2B17.28.07.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="126" src="http://1.bp.blogspot.com/-hmoYVhYpy4g/VRq9H_psaLI/AAAAAAAAMRU/kWfiCxhJgH4/s1600/Screen%2BShot%2B2015-03-31%2Bat%2B17.28.07.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Script From Baidu during the Chinese Github Attack</td></tr></tbody></table><br /><div style="text-align: justify;">After a couple of deobfuscation "raunds" (<a href="http://www.relentless-coding.com/projects/jsdetox/" target="_blank">JDetox</a> would help you out) the piece of javascript coming out the analysis owned two specific URLs: <a href="https://github.com/greatfire">github.com/greatfire</a> and <a href="https://github.com/cn-nytimes">github.com/cn-nytimes</a> . Both of the URLs are mirror sites for GreatFire.org and the Chinese New York Times.         GreatFire and NYT both use GitHub to circumvent the online censorship performed by the Great Firewall of China (GFW).</div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-4iBisjkKn20/VRrCIP_DRlI/AAAAAAAAMRk/bLsgWK6ooIE/s1600/Screen%2BShot%2B2015-03-31%2Bat%2B17.49.28.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://1.bp.blogspot.com/-4iBisjkKn20/VRrCIP_DRlI/AAAAAAAAMRk/bLsgWK6ooIE/s1600/Screen%2BShot%2B2015-03-31%2Bat%2B17.49.28.png" width="333" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Decripted "Malcode"</td></tr></tbody></table><div style="text-align: justify;">The connections path captured by urlquery is shown in the following picture where is almost evident the query to cloudfront comming after having loaded a fake baidu script. </div><div style="text-align: justify;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-Jx9-19rOO6w/VRvB9xcmIcI/AAAAAAAAMSE/qwN2zKnDYCA/s1600/Screen%2BShot%2B2015-04-01%2Bat%2B11.47.33.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/-Jx9-19rOO6w/VRvB9xcmIcI/AAAAAAAAMSE/qwN2zKnDYCA/s1600/Screen%2BShot%2B2015-04-01%2Bat%2B11.47.33.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Connection Flows</td></tr></tbody></table><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Getting little bit deeper -- a malicious payload downloaded from --</div><div style="text-align: left;"><i><br /></i></div><div style="text-align: center;"><div style="text-align: left;"><pre class="wrapword" style="font-size: 14px;"><i><img src="http://urlquery.net/images/flags/cn.png" height="11" title="China<br />AS4808 CNCGROUP IP network China169 Beijing Province Network" width="16" /> 123.125.115.164<br />HTTP/1.0 200 OK<br /><br />Content-Type: text/html<br /></i></pre><pre class="httptransaction wrapword" id="response107" style="display: block; font-size: 14px;"><i>Server: nginx<br />Date: Wed, 18 Mar 2015 09:56:57 GMT<br />Content-Length: 114<br />Last-Modified: Wed, 18 Mar 2015 05:43:55 GMT<br />Etag: "5509109b-72"<br />Expires: Wed, 18 Mar 2015 09:56:57 GMT<br />Cache-Control: max-age=0<br />Accept-Ranges: bytes<br />Connection: keep-alive</i></pre></div><div style="text-align: justify;"></div><div style="text-align: justify;">forced the user browser to load content from:&nbsp; <i>d18yee9du95yb4.cloudfront.net</i></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><pre class="wrapword" style="font-size: 14px;"><i>GET /?1425380212 HTTP/1.1<br /><br />Host: d18yee9du95yb4.cloudfront.net</i></pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;"><i><br />User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)<br />Accept: text/plain, */*; q=0.01<br />Accept-Language: en-us,en;q=0.5<br />Accept-Encoding: gzip,deflate<br />Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7<br />Keep-Alive: 115<br />Connection: keep-alive<br />Referer: http://pos.baidu.com/wh/o.htm?ltr=&amp;cf=u<br />Origin: http://pos.baidu.com</i></pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;"><i>&nbsp;</i></pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;">Currently the host has been blocked<i> down due to the described attack as follows:</i></pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;"><i>&nbsp;</i></pre><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-zivll5D9Xw4/VRu_9jvkkuI/AAAAAAAAMR4/1XbaPmd8B8I/s1600/Screen%2BShot%2B2015-04-01%2Bat%2B11.51.51.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="112" src="http://1.bp.blogspot.com/-zivll5D9Xw4/VRu_9jvkkuI/AAAAAAAAMR4/1XbaPmd8B8I/s1600/Screen%2BShot%2B2015-04-01%2Bat%2B11.51.51.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Blocked host because the "Chinese Attack"</td></tr></tbody></table><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;">&nbsp;</pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;">&nbsp;</pre><pre class="httptransaction wrapword" id="request108" style="display: block; font-size: 14px;">&nbsp;</pre></div></div>I decided to write a little bit about this attack since it is one of the most "dramatic"&nbsp; examples on how "states" might perform wide attacks using unware services and state infrastructures...</div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=GitHub%20and%20the%20Man%20On%20The%20Side%20Attack-http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f&title=GitHub%20and%20the%20Man%20On%20The%20Side%20Attack" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fgithub-and-the-man-on-the-side-attack%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
