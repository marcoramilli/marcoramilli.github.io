<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Automatic Network Service Detector within Twitter Logs. (ARDUINO) &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Mar 29, 2010</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          â€¢ 800 words 4 min. read
        </div>
        <h1>Automatic Network Service Detector within Twitter Logs. (ARDUINO)</h1>
        <section id="post-content" class="article-content post">
          <p>Hey folks, probably you&rsquo;ve heard about the IronGeek hardware <a href="http://www.irongeek.com/i.php?page=security/programmable-hid-usb-keystroke-dongle">Project</a> called &ldquo;programmable-hid-usb-keystroke-dongle&rdquo;. This is a great project man ! Fortunately or unfortunately (it depends on your point of view)  I&rsquo;ve been working on quite the same project from 3 months, utilizing the same platform too. Now I gotta some interesting results too ;). Isn&rsquo;t amazing ? I mean we felt the same need for automatic penetration testing and both of us realized a practical board, with the same chipset. So &hellip; why not collaborate together ? If IronGeek are reading me and if you are interested on collaborate together on what you&rsquo;ve done, please contact me.<br /><br />Anyway, the second step (at least to me), after automatized the in-site security procedures,  is to automate the network service detector using a Black-Box approach. Why BB approach ? The answer is easy, it&rsquo;s intuitive for all the people that are not accustomed with security. Just plug the BB to the network and here we go, it writes up to your private (or not) twitter channel the network results.<br /><br />Ok, that is nice, <b>but what does it do ?</b><br />Alright, the basic idea is to have a physical tool which is able to monitor the network services.<br /><br /><b>Why not a </b><a href="http://www.nagios.org/"><b>nagios</b></a><b> running PC ?</b><br />1- Because a PC is expensive compared to ARDUINO<br />2- Because installing and configuring Nagios keeps much time<br />3- Nagios is very complete and for such reason &hellip; complex<br /><br /><b>Plug &lsquo;n&rsquo; Play idea.</b><br />1- A system which keeps DHCP configurations<br />2- A system which automatically scans our network and automatically generates reports<br />3- A really cheap system<br /><br /><b>How it looks like</b> (No Packaged showed here - packages are under constructions - {I like fashionable black boxes, not really &ldquo;on-fly-ones&rdquo;  ;) })<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_gK7b9huwiwY/S7IfoiLsO9I/AAAAAAAAKS0/ih6QdROJVV4/s1600/IMG_0591.JPG"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 300px; height: 400px;" src="http://3.bp.blogspot.com/_gK7b9huwiwY/S7IfoiLsO9I/AAAAAAAAKS0/ih6QdROJVV4/s400/IMG_0591.JPG" border="0" alt="" id="BLOGGER_PHOTO_ID_5454456879930162130" /></a><br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_gK7b9huwiwY/S7Ifx4sznnI/AAAAAAAAKS8/hSXzBMv4Vu8/s1600/IMG_0592.JPG"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 300px; height: 400px;" src="http://3.bp.blogspot.com/_gK7b9huwiwY/S7Ifx4sznnI/AAAAAAAAKS8/hSXzBMv4Vu8/s400/IMG_0592.JPG" border="0" alt="" id="BLOGGER_PHOTO_ID_5454457040593460850" /></a><br /><br /><div><br /><b>The implementation:</b><br /><b><br /></b><br />Hardware<br />1- ARDUINO 2009<br />2- Ethernet Shield<br />3- Ethernet cable<br /><br />Software<br />Arduino <a href="http://arduino.cc/en/Main/Software">Development Kit</a><br />Arduino<a href="http://blog.jordanterrell.com/post/Arduino-DHCP-Library-Version-04.aspx"> DHCP library</a><br />Arduino <a href="http://www.arduino.cc/playground/Code/TwitterLibrary">Twitter Library</a><br /><br />Step by Step Instructions:<br /><br />1) Install Arduino Development kit</div><div><br />2) Copy Dhcp.cpp and Dhcp.h to <arduino path="">/Resources/java/hardware/libraries/Ethernet/ (for more details follow <a href="http://blog.jordanterrell.com/post/Arduino-DHCP-Library-Version-04.aspx">instructions</a> here. </arduino><br /><br /></div><div>3) Copy Twitter libraries to <arduino path="">/Resources/java/hardware/libraries/</arduino><br /><br />**  If you don&rsquo;t want to spent time to configure your libraries, take <a href="http://87f5b5df.linkbucks.com/">this package</a>, unzip-it, and replace your libraries  (<arduino path="">/Resources/java/hardware/)   <strong></arduino><br /><br />4) Grab the code (sorry I should use SyntaxHighLighter, next time ;) .. probably)<br /><br />/</strong>***********************************************<strong><em>/<br />// Small Arduino Portable Port Scanner<br />// Don&rsquo;t forget the Libraries.<br />// by Marco Ramilli, <a href="http://marcoramilli.blogspot.com">http://marcoramilli.blogspot.com</a><br />// Arduino uses digital pins 10, 11, 12, and 13 (SPI) to communicate with the W5100 on the ethernet shield. These pins cannot be used for general i/o.<br />#include <ethernet.h></ethernet.h><br />#include &ldquo;Dhcp.h&rdquo; //DhCP Library<br />#include <twitter.h> //Twitter API</twitter.h><br />#include <wstring.h> //Used for append strings</wstring.h><br /><br />/</em></strong>**********************************************<strong><em>/<br />//Defult Network Configuration instances for the device<br />byte ip[] = { 192, 168, 2, 50 };<br />byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED };<br />/</em></strong>**********************************************<strong><em>/<br />Twitter twitter(&ldquo;TwitterUserName:TwitterPasswd&rdquo;);//Username and Password for Twitter<br />byte basenetwork[] = { 192, 168, 2, 1 }; // Test a Class C network, put here the NetID, doesn&rsquo;t matter what HostID you choose.<br />String msg;<br />/</em></strong>***********************************************<strong>/<br /><br />void setup()<br />{<br /><br />Serial.begin(9600);<br />delay(1000);<br />Serial.println(&ldquo;DHCP Querying&rdquo;);<br /><br />//DHCP Settings &hellip;<br />if(!getNC()){<br />Ethernet.begin(mac, ip );<br />Serial.println(&ldquo;Setting Default Network Configurations&rdquo;);<br />}<br />}<br /><br />void loop()<br />{<br /><br />Serial.print(&ldquo;connecting&hellip;&rdquo;); printArray(&amp;Serial, &ldquo;.&rdquo;, basenetwork, 4, 10);<br />msg=&ldquo;Server:X.X.X.&ldquo;; msg.append(basenetwork[3]); //building the twitter string<br /><br />for(int port=0; port&lt;= 100; port++){<br />  Client client(basenetwork, port); // trying to connect 65535 !<br />  if (client.connect()) {<br />    Serial.print(&ldquo;Port:&ldquo;); Serial.print(port); Serial.println(&rdquo; <em>OPEN</em> &ldquo;);<br />    msg.append(&rdquo; Port:&ldquo;);<br />    msg.append(port);<br />    msg.append(&rdquo; OPEN &ldquo;);<br />  } else {<br />    Serial.print(&ldquo;Port:&ldquo;); Serial.print(port); Serial.println(&rdquo; CLOSED&rdquo;);<br />  }<br />  client.flush();<br />  client.stop();<br />}<br /><br />msg.append(&ldquo;-&gt;TESTED !&ldquo;);<br />postonTwitter(msg); // sending host result on Twitter !<br /><br /><br />if(basenetwork[3] &lt;= 254){<br />   Serial.println(&ldquo;Calculating new Address&rdquo;);<br />   basenetwork[3] = basenetwork[3] + 1;<br />}<br />else{<br /><br />    Serial.println(&ldquo;Resetting Address&rdquo;);<br />    basenetwork[3] = 1;<br />}<br /><br /><br />}// end loop<br /><br /><br />/</strong>***********************************************<strong><em>/<br />//DHCP client<br />int getNC(){<br />int result = Dhcp.beginWithDHCP(mac);<br />if (result == 1){<br />  byte buffer[6];<br />  Dhcp.getLocalIp(buffer);<br />  Serial.print(&ldquo;ip address: &ldquo;);<br />  printArray(&amp;Serial, &ldquo;.&rdquo;, buffer, 4, 10);<br />  Dhcp.getSubnetMask(buffer);<br />  Serial.print(&ldquo;subnet mask: &ldquo;);<br />  printArray(&amp;Serial, &ldquo;.&rdquo;, buffer, 4, 10);<br />  Dhcp.getGatewayIp(buffer);<br />  Serial.print(&ldquo;gateway ip: &ldquo;);<br />  printArray(&amp;Serial, &ldquo;.&rdquo;, buffer, 4, 10);<br />  Dhcp.getDhcpServerIp(buffer);<br />  Serial.print(&ldquo;dhcp server ip: &ldquo;);<br />  printArray(&amp;Serial, &ldquo;.&rdquo;, buffer, 4, 10);<br />  Dhcp.getDnsServerIp(buffer);<br />  Serial.print(&ldquo;dns server ip: &ldquo;);<br />  printArray(&amp;Serial, &ldquo;.&rdquo;, buffer, 4, 10);<br />  Serial.print(&ldquo;READY&rdquo;);<br />  return 1;<br />}else{<br />Serial.print(&ldquo;No DHCP, Running in default conf&rdquo;);<br />  return 0;<br />}<br />}<br />/</em></strong>***********************************************<strong>/<br />//printArray funciton<br />void printArray(Print <em>output, char</em> delimeter, byte* data, int len, int base){<br />char buf[10] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0};<br />for(int i = 0; i &lt; len; i++)<br />{<br />  if(i != 0)<br />    output-&gt;print(delimeter);<br />  output-&gt;print(itoa(data[i], buf, base));<br />}<br />output-&gt;println();<br />}<br />/</strong>************************************************<strong>/<br />int postonTwitter(char *message){<br />Serial.println(&ldquo;connecting to TWITTER  &hellip;&rdquo;);<br />if (twitter.post(message)) {<br />  int status = twitter.wait();<br />  if (status == 200) {<br />    Serial.println(&ldquo;OK.&rdquo;);<br />    return 1;<br />  } else {<br />    Serial.print(&ldquo;failed : code &ldquo;);<br />    Serial.println(status);<br />    return 0;<br />  }<br />} else {<br />  Serial.println(&ldquo;connection failed.&rdquo;);<br />  return 0;<br />}<br />}<br />/</strong>**************************************************/</div><div><br /></div><div><br /></div><div><br /></div><div>Alright, this is the basic idea. I hope you will enjoy it, please leave feedbacks comments requests or whatever you like. Thanks</div></p>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Automatic%20Network%20Service%20Detector%20within%20Twitter%20Logs.%20%28ARDUINO%29-http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f&title=Automatic%20Network%20Service%20Detector%20within%20Twitter%20Logs.%20%28ARDUINO%29" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fautomatic-network-service-detector-within-twitter-logs.-arduino%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
