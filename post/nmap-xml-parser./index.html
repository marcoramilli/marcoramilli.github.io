<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> NMAP XML Parser. &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Apr 20, 2011</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          â€¢ 400 words 2 min. read
        </div>
        <h1>NMAP XML Parser.</h1>
        <section id="post-content" class="article-content post">
          <div style="text-align: justify;">Hi Folks,</div><div style="text-align: justify;">after a couple of emails on this topic I decided to share some NMAP specific xml parsers. As many of you know through -oX  flag it's possible to save NMAP results into a well-structured xml file. But what about the visualization or the manipulation of such a file ? </div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Many different ways exist:</div><br /><br /><a href="http://4.bp.blogspot.com/-AdC5x6NnT7A/Ta_YaBVmX6I/AAAAAAAAKsA/r_CekMyCYCM/s1600/nmapxsl.jpg" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 286px;" src="http://4.bp.blogspot.com/-AdC5x6NnT7A/Ta_YaBVmX6I/AAAAAAAAKsA/r_CekMyCYCM/s400/nmapxsl.jpg" border="0" alt="" id="BLOGGER_PHOTO_ID_5597930803392044962" /></a><br /><br /><div><br /></div><div><ul><li style="text-align: justify;">First above others the default NMAP command line supporting style sheets to NMAP output: <b>nmap -A -oX --stylesheet http://insecure.org/nmap/data/nmap.xsl scanreport.xml www.example.com</b></li></ul></div><div style="text-align: justify;"><br /></div><div><ul><li style="text-align: justify;"><a href="http://xmlsoft.org/XSLT/">xsltproc</a> is the first external example. It applies different type of  XSLT to the NMAP results in the following way: <b>xsltproc nmap-output.xml -o nmap-output.html</b></li></ul><b><div style="text-align: justify;"><br /></div></b><ul><li style="text-align: justify;"><a href="http://saxon.sourceforge.net/">Saxon</a> a similart xslt processor. You can try in the following way:                                         <b> java -jar saxon9.jar -s:nmap-output.xml -o:nmap-output.html</b></li></ul><b><div style="text-align: justify;"><br /></div></b><ul><li style="text-align: justify;"><a href="http://xml.apache.org/xalan-j/">xalan-java</a> which <span class="Apple-style-span"   style="  ;font-family:arial, helvetica, sanserif;font-size:medium;">is an XSLT processor for transforming XML documents into HTML, text, or other XML document types. You can try it in the following way:                                           </span><span class="Apple-style-span"   style="font-family:arial, helvetica, sanserif;font-size:medium;"><b> java -jar xalan.jar -IN nmap-output.xml -OUT nmap-output.html</b></span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><div style="text-align: justify;"><b><br /></b></div></span><ul><li style="text-align: justify;"><span class="Apple-style-span"   style="font-family:arial, helvetica, sanserif;font-size:medium;"><a href="http://blogs.sans.org/windows-security/2009/06/11/powershell-script-to-parse-nmap-xml-output/">PowerShellScript</a> . This script converts an XML file into a .NET object within properties. Perfect if you need to write a software that keeps as input the NMAP xml output format. For example if you are building your own report software or a NMAP wrapper.</span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><div style="text-align: justify;"><br /></div></span><ul><li style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><a href="http://www.blackhat.org/JSN/Blog/Entries/2011/4/19_NMAP_-_XML_Flat_File.html">NMAP-XML Flat File</a> converts NMAP xml file format into a HTML or EXCEL  table. It's written in java and it's pretty "download 'n run".                                                                        <b>java XMLNMAPReader <span class="Apple-style-span" style="font-weight: normal; "><b>nmap-output.xml</b></span>l &gt; OutputFile.[html/xls]</b></span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><div style="text-align: justify;"><b><br /></b></div></span><ul><li style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><a href="http://blog.poultonfam.com/brad/2010/02/24/python-nmap-xml-parser/">NMAP Python XML-Parser</a> it translates xml results into .csv file.</span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><br /></span><ul><li style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><a href="http://pbnj.sourceforge.net/">PBNJ</a>. Well it does much more that parsing NMAP XML, but for this post it is able to save NMAP xml file into a database.</span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><div style="text-align: justify;"><br /></div></span><ul><li style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><a href="http://www.redspin.com/blog/2009/10/27/nmap-database-output-xml-to-sql/">NMAP2DB</a> is a great  tool for popolating SQLite databases with NMAP results</span></li></ul><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><div style="text-align: justify;"><br /></div></span><ul><li style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;"><a href="http://rubynmap.sourceforge.net/">Ruby Nmap Parser Library</a>. Great library for rubyans providing  Ruby interface to Nmap's scan data. It can run Nmap and parse its XML output directly from the scan, parse a file containing the XML data from a separate scan, parse a String of XML data from a scan, or parse XML data from an object via its read() method. </span></li></ul><div style="text-align: justify;"><span class="Apple-style-span"  style="font-family:arial, helvetica, sanserif;">Well, I am pretty sure there are tons of other ways to modify NMAP xml format around Internet, so please feel free to add comments suggesting what is your own way or what is your favorite tool.</span></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=NMAP%20XML%20Parser.-http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f&title=NMAP%20XML%20Parser." target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fnmap-xml-parser.%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
