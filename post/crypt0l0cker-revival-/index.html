<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Crypt0l0cker Revival ! &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Feb 12, 2017</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          â€¢ 1100 words 6 min. read
        </div>
        <h1>Crypt0l0cker Revival !</h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on">A couple of days ago a colleague of mine gave me a "brand new" malicious content delivered by a single HTML page. The page was sent to an email box as part of a biggest attack. I found that vector particularly fun and so I'd like to share some of the steps who took me through a personal investigation path made not for professional usage but just for fun.<br /><br />At first sight the HTML page looks like the following image.<br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-MRFn81Yc4oA/WJ66XyMgm_I/AAAAAAAANyo/87zHSTbd-VkJS35wXBCnV98Srzipq6E5wCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B08.15.46.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="160" src="https://1.bp.blogspot.com/-MRFn81Yc4oA/WJ66XyMgm_I/AAAAAAAANyo/87zHSTbd-VkJS35wXBCnV98Srzipq6E5wCLcB/s320/Schermata%2B2017-02-11%2Balle%2B08.15.46.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure1: Attack Vector. A simple HTML page</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">A white backgrounded HTML page with a single line test on it saying: "print this document please". But what document ? Honestly I am in front of one of the ugliest "fake email" I ever seen. But let's move on and se what it really carries on. Opening the HTML content with a simple editor we might see a suspicious obfuscated Javascript. We are facing a first obfuscation stage.&nbsp;</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-O5RooHoq3eg/WJ671jFcHCI/AAAAAAAANy0/0XQVo5FEH081Q2gZoF14szEqlPawAPCBQCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B08.21.48.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="221" src="https://4.bp.blogspot.com/-O5RooHoq3eg/WJ671jFcHCI/AAAAAAAANy0/0XQVo5FEH081Q2gZoF14szEqlPawAPCBQCLcB/s400/Schermata%2B2017-02-11%2Balle%2B08.21.48.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure2: Obfuscated First Stage</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">Since Javascript is an interpreted language (such as .NET or .Java) is not hard to understand its behavior, indeed after some rounds of "substitutions" and "concatenations" it easy to get the following clear text result showing the end of the first stage.</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-H18UjMavfCs/WJ682bu5B8I/AAAAAAAANzA/pOrYRpR-8mwL55NNufn378BAZmmK3W0nACLcB/s1600/Schermata%2B2017-02-11%2Balle%2B08.27.07.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="48" src="https://4.bp.blogspot.com/-H18UjMavfCs/WJ682bu5B8I/AAAAAAAANzA/pOrYRpR-8mwL55NNufn378BAZmmK3W0nACLcB/s400/Schermata%2B2017-02-11%2Balle%2B08.27.07.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure3: Clear Text First Stage</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;">That script is going to create an additional "script tag" on the current document by injecting an external script from: "<span style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/FileSaver.js</span>". The injected script will be called with the following code signature: "<span style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">saveAs(blob, 'image.js');</span>" with 2 arguments:&nbsp;</div><div class="separator" style="clear: both; text-align: justify;"></div><ol><li><b>blob</b>. The raw content of "big_encoded_data" (please refer to Figure3)</li><li><b>image.js</b>. The saving name</li></ol><div>In order to better understand what that function saveAs(blob, image.js) does we need to analyze the external FileServer.js. The entry point of the external script is the function "saveAs(arg1, arg2)" which has been defined as follows:</div><div><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-MecHnPmKeAM/WJ6-RJ_L3FI/AAAAAAAANzQ/Wp_-sNDpIzYc-To9vryqwwfT8Q4VjdznwCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B08.32.01.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="82" src="https://4.bp.blogspot.com/-MecHnPmKeAM/WJ6-RJ_L3FI/AAAAAAAANzQ/Wp_-sNDpIzYc-To9vryqwwfT8Q4VjdznwCLcB/s400/Schermata%2B2017-02-11%2Balle%2B08.32.01.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure4: FileServer.js Original Entry</td></tr></tbody></table><div style="text-align: center;"><br /></div><br /><div class="separator" style="clear: both; text-align: left;">saveAs(blob, name) is a simple wrapper function headed to FileServer constructor which is defined as follows:</div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/-Q1m1FRBLcwA/WJ6_Wc0RpHI/AAAAAAAANzc/hkX357K8_VYzRyzavpolePTBOk9t6dsHwCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B08.37.35.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="391" src="https://3.bp.blogspot.com/-Q1m1FRBLcwA/WJ6_Wc0RpHI/AAAAAAAANzc/hkX357K8_VYzRyzavpolePTBOk9t6dsHwCLcB/s400/Schermata%2B2017-02-11%2Balle%2B08.37.35.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure5: FileServer.js constructor</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">The script saves the "blob" content to the temporary folder giving to it a specific name (image.js in our case). As you might notice from the script content: "</span><span style="text-align: left; white-space: pre-wrap;">Apple do not allow window.open, see http://bit.ly/1kZffRI " if the victims opens the file with Safari/Mail the attack vector will have no effect since Safari/Mail does not allow you to trigger the script on "window.open" event. This is why I did't see any file when I opened the infected HTML content. Back to the original script (Figure3) we see the aveAs function called on page.load so the resulting image.js is going to be saved in the temporary local folder, in case of email clients, it will be triggered as soon as saved! So lets move on our next stage: the <b>big_encoded_data </b></span><span style="text-align: left; white-space: pre-wrap;">variable</span><b style="text-align: left; white-space: pre-wrap;"> </b><span style="text-align: left; white-space: pre-wrap;">(Figure3) which is going to be saved as image.js file. The big_encoded_data owns a first obfuscation stage made by encoding the downloader in base64. Once decoded from base64 and beautified the results looks like the following image</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-2SPGni1PqfU/WJ7N1MVEsEI/AAAAAAAANz0/o0t5FjKC0Q8hpdA3kRsOK4PyqtkgBGulQCLcB/s1600/Schermata%2B2017-02-10%2Balle%2B14.05.37.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="357" src="https://1.bp.blogspot.com/-2SPGni1PqfU/WJ7N1MVEsEI/AAAAAAAANz0/o0t5FjKC0Q8hpdA3kRsOK4PyqtkgBGulQCLcB/s400/Schermata%2B2017-02-10%2Balle%2B14.05.37.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure6: Stage 2 base64 decoded obfuscated downloader</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;">The downloader is still obfuscated by a high number of simple returning array-strings variables. It took almost 45 minutes to decode the entire second stage downloader. The resulting downloader is shown in the following image.</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-QhHB1SxCjpM/WJ7Pn0hpPZI/AAAAAAAAN0E/MchDmzAX-Zgr7A4KjXsPtKf2-5yF3VeSwCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B09.47.10.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="207" src="https://4.bp.blogspot.com/-QhHB1SxCjpM/WJ7Pn0hpPZI/AAAAAAAAN0E/MchDmzAX-Zgr7A4KjXsPtKf2-5yF3VeSwCLcB/s400/Schermata%2B2017-02-11%2Balle%2B09.47.10.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure7: Second Stage Downloader</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;">A first check on fileSystem API and on the Element Type is super interesting (at least to me). We are analyzing an attack based on a specific file system, Windows native. The deobfuscated downloader grabs a file from  </span><span style="background-color: #eeeeee; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"http://mit.fileserver4390.org/file/nost.bgt" </span><span style="text-align: left; white-space: pre-wrap;">and saves it to a temporary directory. By using <b>ActiveXObject </b>(Windows native) it saves the file and it runs it through command line </span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">c</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">[</span><span class="str" style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"run"</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">](</span><span class="str" style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"cmd.exe /c "</span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> </span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">+</span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> f </span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">+</span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> g</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">,</span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> </span><span class="str" style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"0"</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">); </span><span style="text-align: left; white-space: pre-wrap;">where f takes the temporary folder</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">  </span><span class="pln" style="font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">f </span><span class="pun" style="color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">=</span><span class="pln" style="font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> b</span><span class="pun" style="color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">[</span><span class="str" style="color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"GetSpecialFolder"</span><span class="pun" style="color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">](</span><span class="str" style="color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"2"</span><span class="pun" style="color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">); </span><span style="text-align: left; white-space: pre-wrap;">and g takes the temporary name </span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">g </span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">=</span><span class="pln" style="background-color: whitesmoke; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"> b</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">[</span><span class="str" style="background-color: whitesmoke; color: #008800; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">"GetTempName"</span><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;">]();.</span></div><div class="separator" style="clear: both; text-align: justify;"><span class="pun" style="background-color: whitesmoke; color: #666600; font-family: &quot;menlo&quot; , &quot;monaco&quot; , &quot;consolas&quot; , &quot;courier new&quot; , monospace; font-size: 12.025px; text-align: left; white-space: pre-wrap;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;">This is the end of the second </span><span style="text-align: left; white-space: pre-wrap;">stage </span><span style="text-align: left; white-space: pre-wrap;">downloader. </span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;">The downloaded file is a PE Executable packed as well. Fortunately the used packer is the PiMP Stub by Nullsoft: a quite famous installer used by several software house. </span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-mrAARhlDQ9w/WJ7SKrIMIYI/AAAAAAAAN0U/jDRSolhqpU4k1iK6ePo98wGCHNSSVu0zACLcB/s1600/Schermata%2B2017-02-10%2Balle%2B14.02.24.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="180" src="https://2.bp.blogspot.com/-mrAARhlDQ9w/WJ7SKrIMIYI/AAAAAAAAN0U/jDRSolhqpU4k1iK6ePo98wGCHNSSVu0zACLcB/s320/Schermata%2B2017-02-10%2Balle%2B14.02.24.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure8: NullSoft Installer</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left; white-space: pre-wrap;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">The PiMP installer takes .dlls and runs them as the resulting software. The used resources are compressed in its own body by a well known algorithm: .7zip. Kation.DLL is the only DLL included in the dropped file and so it is the run DLL by PiMP installer. Kation wraps out ADVAPI32.DLL and KERNEL32.DLL as you might see from Figure9. ADVAPI32 is a core Microsoft library which includes the Microsoft encryption libraries such as: EncryptFileA, EncryptFileW and so on and so forth. It's not hard to guess a new Ransomware infection from that API calls.</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-AjWyMjTK2es/WJ7W5YjcM5I/AAAAAAAAN0k/7b0xKAY3hbY9SnwHnGUpvnewhcx2YbggACLcB/s1600/Schermata%2B2017-02-11%2Balle%2B10.18.05.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="132" src="https://2.bp.blogspot.com/-AjWyMjTK2es/WJ7W5YjcM5I/AAAAAAAAN0k/7b0xKAY3hbY9SnwHnGUpvnewhcx2YbggACLcB/s400/Schermata%2B2017-02-11%2Balle%2B10.18.05.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure9: Usage of Encryption Libraries</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">From a static analysis prospective it becomes clear that some of the used strings are dynamically allocated. For example in <b>sub_10001170</b> (frame <b>0XBC</b>) several UFT-16 strings within decryption loop are involved showing out the control flow passing to <b>Etymology.Vs </b>(Figure11).</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://2.bp.blogspot.com/-qksCBbndWUA/WJ8oEgBz1YI/AAAAAAAAN00/1NIRD1LP1b8JtfHRhcZlfKsA_rp9NRhuQCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B16.03.37.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="207" src="https://2.bp.blogspot.com/-qksCBbndWUA/WJ8oEgBz1YI/AAAAAAAAN00/1NIRD1LP1b8JtfHRhcZlfKsA_rp9NRhuQCLcB/s400/Schermata%2B2017-02-11%2Balle%2B16.03.37.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure10: Setting the running pointer</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/-eSXsZ4-86cs/WJ8s2v1nXyI/AAAAAAAAN1E/d8wacJ6CkQEnvVPMA05WQdtF8i5A-tmdQCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B16.24.49.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="367" src="https://3.bp.blogspot.com/-eSXsZ4-86cs/WJ8s2v1nXyI/AAAAAAAAN1E/d8wacJ6CkQEnvVPMA05WQdtF8i5A-tmdQCLcB/s400/Schermata%2B2017-02-11%2Balle%2B16.24.49.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure11: Decoding Functions</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">The real behavior is hidden into the Etymology.Vs encrypted file included in the PiMP solution as well. Running the infected sample it disclosures its real behavior: shown in Figure12.</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-92je39ZYjc8/WJ8-tbJnTYI/AAAAAAAAN1o/ehFqESmEYj02mcGsuGCXWlKHPmdnBWscgCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B12.22.49.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="156" src="https://1.bp.blogspot.com/-92je39ZYjc8/WJ8-tbJnTYI/AAAAAAAAN1o/ehFqESmEYj02mcGsuGCXWlKHPmdnBWscgCLcB/s400/Schermata%2B2017-02-11%2Balle%2B12.22.49.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure12: Ransom Request</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">Here we go, &nbsp;we have just discovered a brand new <b>Crypt0L0cker</b> ! it asks for bitcoin (Figure13), of course. &nbsp;Looking at network communications, a <b>Domain Name Generator Algorithm</b>&nbsp;(DNGA), [wow, it sounds new from CryptoL0Cker !] fires up as soon as the dropped file is executed. It looks for valid registered subdomains belonging with <b>divamind.org</b>. &nbsp;Until a valid Command and Control answers to the CryptoLocker client it hides itself and performs simple DNS query as follows:</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="p1"><span class="s1">&nbsp;28&nbsp;</span><span class="s2"> imadyxaro.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;29&nbsp;</span><span class="s2"> irel.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;30&nbsp;</span><span class="s2"> awwtodufir.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;31&nbsp;</span><span class="s2"> ogisirigu.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;32&nbsp;</span><span class="s2"> yzijyvy.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;33&nbsp;</span><span class="s2"> uqekfr.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;34&nbsp;</span><span class="s2"> ydoc.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;35&nbsp;</span><span class="s2"> yzukyfyku.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;36&nbsp;</span><span class="s2"> upenigy.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;37&nbsp;</span><span class="s2"> qhera.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;38&nbsp;</span><span class="s2"> ijywiqezy.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;39&nbsp;</span><span class="s2"> efuca.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;40&nbsp;</span><span class="s2"> ygbm.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;41&nbsp;</span><span class="s2"> ejrdip.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;42&nbsp;</span><span class="s2"> usen.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;43&nbsp;</span><span class="s2"> ahydenuj.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;44&nbsp;</span><span class="s2"> ghxsykegaja.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;45&nbsp;</span><span class="s2"> ekohob.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;46&nbsp;</span><span class="s2"> ifyvas.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;47&nbsp;</span><span class="s2"> iqimub.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;48&nbsp;</span><span class="s2"> usegi.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;49&nbsp;</span><span class="s2"> yjeqicoht.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;50&nbsp;</span><span class="s2"> rtibola.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;51&nbsp;</span><span class="s2"> ucnpive.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;52&nbsp;</span><span class="s2"> aminevkjude.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;53&nbsp;</span><span class="s2"> pwiregaty.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;54&nbsp;</span><span class="s2"> irol.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;55&nbsp;</span><span class="s2"> abswuhupnt.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;56&nbsp;</span><span class="s2"> erelo.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;57&nbsp;</span><span class="s2"> ulefuw.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;58&nbsp;</span><span class="s2"> ogax.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;59&nbsp;</span><span class="s2"> ezelilijxn.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;60&nbsp;</span><span class="s2"> ulymobutol.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;61&nbsp;</span><span class="s2"> obehilebac.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;62&nbsp;</span><span class="s2"> yfycodolul.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;63&nbsp;</span><span class="s2"> iwesvxynd.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;64&nbsp;</span><span class="s2"> kcoma.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;65&nbsp;</span><span class="s2"> ydqpibc.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;66&nbsp;</span><span class="s2"> ykotifehut.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;67&nbsp;</span><span class="s2"> ewuzivy.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;68&nbsp;</span><span class="s2"> imocyfyt.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;69&nbsp;</span><span class="s2"> fjep.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;70&nbsp;</span><span class="s2"> ibeb.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;71&nbsp;</span><span class="s2"> isafexuh.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;72&nbsp;</span><span class="s2"> izemireli.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;73&nbsp;</span><span class="s2"> kgorihukyho.divamind.org&nbsp;</span></div><div class="p1"><span class="s1">&nbsp;74&nbsp;</span><span class="s2"> udupose.divamind.org&nbsp;</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">    <style type="text/css">p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Andale Mono'; color: #28fe14; background-color: #000000; background-color: rgba(0, 0, 0, 0.9)} span.s1 {font-variant-ligatures: no-common-ligatures; color: #ecec15} span.s2 {font-variant-ligatures: no-common-ligatures} </style>                                                 </span></div><div class="p1"><span class="s1">&nbsp;75&nbsp;</span><span class="s2"> iqyk.divamind.org&nbsp;</span></div><div class="separator" style="clear: both; text-align: justify;"><br /></div><div class="separator" style="clear: both; text-align: left;">The process to contact the Command and Control in order to exchange key and to notify the attacker could be very time consuming, in some of my runs it took until 2 hours depending on the available Command and Control at the time being. It would be very nice to have extra time to reverse the DNGA but unfortunately my weekend time is ending up.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-DJmEHNkSIT0/WJ8-l8WnKvI/AAAAAAAAN1k/YzemRChajEgKPmVsw3wr3eWpXQ2ees81gCLcB/s1600/Schermata%2B2017-02-11%2Balle%2B16.11.16.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="302" src="https://4.bp.blogspot.com/-DJmEHNkSIT0/WJ8-l8WnKvI/AAAAAAAAN1k/YzemRChajEgKPmVsw3wr3eWpXQ2ees81gCLcB/s400/Schermata%2B2017-02-11%2Balle%2B16.11.16.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure13: Ransom Request Web Page</td></tr></tbody></table><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">Development language is French, and many piece of code reminds me the "gaming world". &nbsp; The main Command and Control domain is registered in Moscow (RU) and the registrant is "privacy protected".</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="whoisHeaders" style="background-color: white; border-bottom: 1px solid rgb(213, 213, 213); float: left; font-family: open_sans, sans-serif; font-size: 13px; font-weight: bold; margin: 5px 30px 5px 5px; padding: 5px; position: relative; width: 436.5px;">Results for Target: divamind.org</div><div style="background-color: white; clear: both; color: #666666; font-family: open_sans, sans-serif; font-size: 12px;"></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"></span></div><div class="whoisDataContainer" id="whoisDates" style="background-color: white; color: #666666; float: left; font-family: open_sans, sans-serif; font-size: 12px; margin: 0px 30px 5px 5px; padding: 5px; position: relative; width: 436.5px;"><table border="0" cellpadding="2" cellspacing="0"><tbody><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;" width="120"><strong>Created Date :</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">2017-02-07T12:37:10Z</td></tr><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;" width="120"><strong>Updated Date :</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">2017-02-08T10:38:54Z</td></tr><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;"><strong>WHOIS Server:</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">whois.pir.org</td></tr></tbody></table></div><div class="whoisHeaders" style="background-color: white; border-bottom: 1px solid rgb(213, 213, 213); float: left; font-family: open_sans, sans-serif; font-size: 13px; font-weight: bold; margin: 5px 30px 5px 5px; padding: 5px; position: relative; width: 436.5px;">Results for Target: divamind.org</div><div style="background-color: white; clear: both; color: #666666; font-family: open_sans, sans-serif; font-size: 12px;"></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"></span></div><div class="whoisDataContainer" id="whoisDates" style="background-color: white; color: #666666; float: left; font-family: open_sans, sans-serif; font-size: 12px; margin: 0px 30px 5px 5px; padding: 5px; position: relative; width: 436.5px;"><table border="0" cellpadding="2" cellspacing="0"><tbody><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;" width="120"><strong>Created Date :</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">2017-02-07T12:37:10Z</td></tr><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;" width="120"><strong>Updated Date :</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">2017-02-08T10:38:54Z</td></tr><tr><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;"><strong>WHOIS Server:</strong></td><td style="font-family: &quot;Trebuchet MS&quot;, sans-serif; font-size: 12px; line-height: 16.2px; margin-top: 0px;">whois.pir.org</td></tr></tbody></table></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b><br /></b></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">The ransom page (available on the following link) is registered by EPAG Domain Sercives GmbH (Bonn, Germany) and is written in Franc language:&nbsp;</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">http://x5sbb5gesp6kzwsh.hoptrop.pl/uum2j9ku.php?user_code=<code>&amp;user_pass=<pass_code>&amp;page_id=0</pass_code></code></span></div><div class="separator" style="clear: both; text-align: justify;"><br /></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b><br /></b></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b>Ok Let's have some brand new IoC:</b></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b><br /></b></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b>Malicious hashes:</b></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">2649cba6ca799e15c45fa59472031cc9087a5ade</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">6ef0e56b27cfd3173aeded9be9d05e97d8e36da3</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">7292f20a0909f5f9429d5c1ec2896cf8f57a40a2</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">0b7b7201310638a74dba763c228d8afe77303802</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;">2d36b1bf1c37d6f5b47fe36bd2c5bac81b517774</span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: justify;"><span style="text-align: left;"><b>Malicious urls:</b></span></div>http://mit.fileserver4390.org/file/nost.bg <br />http://x5sbb5gesp6kzwsh.hoptrop.pl<br />http://xiodc6dmizahhijj.onion<br /><br /><b>DNGA:</b><br />- base dns: XXXXXXX.divamind.org<br /><br /><b>Extension:</b><br />.?????? (6 characters)<br /><br /><b>Strings:</b><br />HOW_TO_RESTORE_FILES<br /><br />Enjoy your new IoC</div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Crypt0l0cker%20Revival%20%21-http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f&title=Crypt0l0cker%20Revival%20%21" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcrypt0l0cker-revival-%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
