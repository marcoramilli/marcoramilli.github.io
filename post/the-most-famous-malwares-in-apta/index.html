<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> The Most Famous Malwares in APTA &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Oct 13, 2014</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 1400 words 7 min. read
        </div>
        <h1>The Most Famous Malwares in APTA</h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on">During my talks and during my daily working life people asks me about the most interesting Malware used to perform Advanced Persistent Targeted Attacks (APTA). So I decided to give my personal answer in this post, beeing concious that things would change pretty soon.<br /><br />Lets start with <span style="color: red;"><b>Stuxnet</b></span>, maybe one of the most known APTA known in the history, also responsible to giving pubblic begin to the cyber-espionage.<br /><br /><div style="text-align: justify;"><blockquote class="tr_bq">Stuxnet is a computer worm that was discovered in June 2010. It was designed to attack industrial Programmable Logic Controllers or PLCs. PLCs allow the automation of electromechanical processes such as those used to control machinery on factory assembly lines, amusement rides, or centrifuges for separating nuclear material. Exploiting four zero-day flaws, Stuxnet functions by targeting machines using the Microsoft Windows operating system and networks, then seeking out Siemens Step7 software. Stuxnet reportedly compromised Iranian PLCs, collecting information on industrial systems and causing the fast-spinning centrifuges to tear themselves apart. Stuxnet’s design and architecture are not domain-specific and it could be tailored as a platform for attacking modern SCADA and PLC systems (e.g. in the automobile or power plants), the majority of which reside in Europe, Japan and the US.Stuxnet reportedly ruined almost one-fifth of Iran's nuclear centrifuges.</blockquote><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-1l22TYOgkmU/VBAGOvVlncI/AAAAAAAAL5Q/MrQk6K2VQQI/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B10.03.51.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-1l22TYOgkmU/VBAGOvVlncI/AAAAAAAAL5Q/MrQk6K2VQQI/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B10.03.51.png" height="253" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From TrendMicro <a href="http://about-threats.trendmicro.com/us/webattack/54/STUXNET%20Malware%20Targets%20SCADA%20Systems" target="_blank">Report </a></td></tr></tbody></table><br /><br />Stuxnet has three modules:<br /><ol><li>a <b>worm</b> that executes all routines related to the main payload of the attack;&nbsp;</li><li>a <b>link</b> file that automatically executes the propagated copies of the worm; and&nbsp;</li><li>a <b>rootkit</b> component responsible for hiding all malicious files and processes, preventing detection of the presence of Stuxnet.&nbsp;</li></ol>Stuxnet was able to exploit the following vulnearbilities: CVE-2010-2568, CVE-2008-4250, CVE-2010-2729 and CVE-2010-277. It mainly got started from USB sticks and spread over PCs throught vulns. What it did was to substitute a Siemens DLL getting control of Siemens SCADA systems. A later updated version was also able to exploit the CVE-2010-2772being able to read and write directly on Siemens SCADA database (.DBI).<br /><br />Another great example is <span style="color: red;"><b>Flame</b></span>.<br /><blockquote class="tr_bq"><br />also known as <b>Flamer</b>, <b>sKyWIper</b> and <b>Skywiper</b>, is modular computer malware discovered in 2012 that attacks computers running the Microsoft Windows operating system. The program is being used for targeted cyber espionage in Middle Eastern countries.Flame can spread to other systems over a local network (LAN) or via USB stick. It can record audio, screenshots, keyboard activity and network traffic. The program also records Skype conversations and can turn infected computers into Bluetooth beacons which attempt to download contact information from nearby Bluetooth-enabled devices. This data, along with locally stored documents, is sent on to one of several command and control servers that are scattered around the world. The program then awaits further instructions from these servers. </blockquote><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-PN_5lEuTQZk/VBAKWhxoeaI/AAAAAAAAL5c/AXS5wmOD_CU/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B10.20.43.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-PN_5lEuTQZk/VBAKWhxoeaI/AAAAAAAAL5c/AXS5wmOD_CU/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B10.20.43.png" height="375" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">SecureList <a href="http://securelist.com/blog/incidents/34344/the-flame-questions-and-answers-51/" target="_blank">Thread</a></td></tr></tbody></table><br />Flame was actualy one of the most complext computer malware ever. Super "heavy" it comes within database server, very uncommon virtual machines (lua), file sharing, specific "red protocols", gzlibs, encryption libs and so on.. A great client analysis can be found <a href="http://www.symantec.com/connect/blogs/flamer-highly-sophisticated-and-discreet-threat-targets-middle-east" target="_blank">here</a>. My favorite Server analysis can be found <a href="http://securelist.com/blog/incidents/34216/full-analysis-of-flames-command-control-servers-27/" target="_blank">here</a>.<br /><br /><br /><span style="color: red;"><b>Duqu</b></span> is another big name in the APTA's world.<br /><br /><blockquote class="tr_bq"><b>Duqu</b> malware is a variety of software components that together provide services to the attackers. Currently this includes information stealing capabilities and in the background, kernel drivers and injection tools. Part of this malware is written in unknown high level programming language, dubbed "Duqu framework". It is not C++, Python, Ada, Lua and many other checked languages. However, recent evidence suggests that Duqu may have been written in Object Oriented C (OO C) and compiled in Microsoft Visual Studio 2008.</blockquote><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-z2T5tQjF2zE/VBBBroKUd2I/AAAAAAAAL5s/gzEsxptJN6g/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B14.18.26.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-z2T5tQjF2zE/VBBBroKUd2I/AAAAAAAAL5s/gzEsxptJN6g/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B14.18.26.png" height="375" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><b>Duqu</b> main components and modules from <a href="http://www.crysys.hu/publications/files/bencsathPBF11duqu.pdf" target="_blank">this report</a></td></tr></tbody></table><br />The&nbsp; dropper file recovered and disclosed by CrySyS Lab uses a Microsoft Word (.doc) document which exploits the <b>Win32k TrueType</b> font parsing engine and allows execution (btw, a nice article on that vulnerability <a href="http://www.zdnet.com/blog/security/microsoft-issues-temporary-fix-it-for-duqu-zero-day/9764" target="_blank">is here</a>). The Duqu dropper relates to font embedding, and thus relates to the workaround to restrict access to T2EMBED.DLL, which is a TrueType font parsing engine if the patch released by Microsoft in December, 2011 is not yet installed. Microsoft identifier for the threat is MS11-087. Duqu has tons of similarity with Stuxnet, common code have been prooved.<br /><br /><br />A most recent attack to spy diplomats'name is <span style="color: red;"><b>Turla</b></span>.<br /><br /><blockquote class="tr_bq"><b>Turla</b> has been used for classic espionage-type operations for at least four years. Because of the targets chosen and the advanced nature of the malware used, Symantec believes that a state-sponsored group was behind these attacks.  Turla provides the attacker with powerful spying capabilities. Configured to start every time a computer starts, once the user opens a Web browser it opens a back door that enables communication with the attackers. Through this back door, the attackers can copy files from the infected computer, connect to servers, delete files, and load and execute other forms of malware, among other capabilities. The group behind Turla uses spear phishing emails and watering hole  attacks to infect victims. Some of the spear phishing emails purported  to come from a military attaché at a Middle Eastern embassy and had an  attachment masquerading as the minutes of meetings. Opening the  attachment resulted in Trojan.Wipbot being dropped on to the victim’s  computer. It is believed that Wipbot may be the delivery mechanism for  Turla as they share several similarities in code and structure.</blockquote><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-L3ytbq2sGS8/VBBGpz6whCI/AAAAAAAAL58/kV9O2C8U45g/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B14.39.32.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-L3ytbq2sGS8/VBBGpz6whCI/AAAAAAAAL58/kV9O2C8U45g/s1600/Screen%2BShot%2B2014-09-10%2Bat%2B14.39.32.png" height="640" width="246" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">How Turla is pread, from <a href="http://www.symantec.com/connect/blogs/turla-spying-tool-targets-governments-and-diplomats" target="_blank">here</a>.</td></tr></tbody></table>&nbsp;Turla malware has been used to to facilitate watering hole attacks since 2012, its most advanced feature was to be totally FUD for many years. Later on it has been used to deliver Wipbot, a famous malware used to gather further information about the infected computer. If the attackers deemed the victim of interest, it appears likely that a second back door (Trojan.Turla) with far greater capabilities was downloaded on to the victim’s computer.<br /><br />In 2012 <b><span style="color: red;">Gauss</span></b> Malware hit the Middle east community.<br /><br />Like Flame and Duqu, the propagation of Gauss seems to be controlled in order to maintain stealth and avoid detection. Gauss is a complex, nation-state sponsored cyber-espionage toolkit designed to steal sensitive data, with a specific focus on browser passwords, online banking account credentials, cookies, and specific configurations of infected machines. The online banking Trojan functionality found in Gauss is a unique characteristic that was not found in any previously known cyber-weapons. Kaspersky write: “The payload is run by infected USB sticks and is designed to surgically target a certain system (or systems) which have a specific program installed. One can only speculate on the purpose of this mysterious payload.” The malware copies itself onto any clean USB inserted into an infected PC, then collects data if inserted into another machine, before uploading the stolen data when reinserted into a Gauss-infected machine. <br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-VE3xoDALRKk/VB8jjDm1eLI/AAAAAAAAL7I/BxNDvVFrFEE/s1600/Screen%2BShot%2B2014-09-21%2Bat%2B21.13.33.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-VE3xoDALRKk/VB8jjDm1eLI/AAAAAAAAL7I/BxNDvVFrFEE/s320/Screen%2BShot%2B2014-09-21%2Bat%2B21.13.33.png" height="245" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From kaspersky labs</td></tr></tbody></table><br /><b><span style="color: red;">HiKit</span></b> is one of the most advanced RootKit used in APTA.<br /><br />Entirely described by Mandiant (<a href="https://www.mandiant.com/blog/hikit-rootkit-advanced-persistent-attack-techniques-part-1-2/" target="_blank">Here</a> and <a href="https://www.mandiant.com/blog/hikit-rootkit-advanced-persistent-attack-techniques-part-2/" target="_blank">Here</a>) the “Hikit” Malware uses an interesting covert mechanism for command and control.  It installs itself as a virtual network adapter layered between the NIC and overlying protocol drivers.  This allows it to covertly monitor incoming packets, intercept command and control data as it enters the network stack, and then spawn user-mode threads to parse them accordingly.<br /><br />(Extracted from Mandiant Analysis)<br /><blockquote class="tr_bq">HiKit writes to the system&nbsp; two main files :<br /><ol><li>C:\WINDOWS\system32\wbem\oci.dll&nbsp;</li><li>C:\WINDOWS\system32\drivers\W7fw.sys&nbsp;</li></ol>“oci.dll” extracts a number of files from its resources section:<br /><ol><li>The rootkit driver “W7fw.sys”&nbsp;</li><li>&nbsp;Several requisite .INF and .CAT files for the driver&nbsp;</li><li>A digital certificate “GlobalSign.cer”, along with a copy of Microsoft’s Certificate Manager tool “certmgr.exe”&nbsp;</li></ol>The attacker self-generated “GlobalSign.cer” to masquerade a legitimate certificate issued by GlobalSign – it was not stolen nor legitimate.  The malware proceeds to use “certmgr.exe” to install the certificate to the local trust store as a root CA and Trusted Publisher using the following two commands:&nbsp;</blockquote><blockquote class="tr_bq"><ul><li>certmgr.exe -add GlobalSign.cer -c -s -r localMachine Root</li><li>certmgr.exe -add GlobalSign.cer -c -s -r localMachineTrustedPublisher&nbsp;</li></ul></blockquote><blockquote class="tr_bq">It then attempts to disable driver signing verification by tampering with several registry keys.  Finally, it completes the driver installation process and checks that it is properly loaded.</blockquote>After the installation and the infection procedure HiKit starts to grab usernames and passwords of Window Locals and Windowns Remote accesses as well as well-known profiles of internet banking and famous serives. It does provide a modular backdoor to manage the malware and the hosting system&nbsp;<br /><br />I am aware those are only some of the most famous Malware used in APTA, I am aware this little "list" will change over time as well, but as now, I believe those Malware are the most remarkable in APTA. </div><div style="text-align: justify;"><br /><br /><br /><br /><br /><br /><br /></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=The%20Most%20Famous%20Malwares%20in%20APTA-http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f&title=The%20Most%20Famous%20Malwares%20in%20APTA" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fthe-most-famous-malwares-in-apta%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
