<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Fighting Ransomware Threats  &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Aug 1, 2016</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 1300 words 6 min. read
        </div>
        <h1>Fighting Ransomware Threats </h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">I wrote a little bit about Ransomware general view and Ransomware general infection methods&nbsp;<a href="http://marcoramilli.blogspot.it/2016/02/ransomware-general-view-after-field.html">here</a>.</div><div style="text-align: justify;">Today, after some more months working on the field and after having meet much more Ransomware than I thought, I'd like to write a little bit about how to "fight them".</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Before starting the review of some of the most known strategies to fight Ransomware let me explain why nowadays Ransomware are not "fair" as they were few months ago. Indeed while back at the beginning of 2016 Ransomware writers would assure your data back once paid the ransom, today's Ransomware writers don't assure it (there are several &nbsp;paid ransoms with unrecovered files examples just few of them: <a href="http://www.extremetech.com/extreme/229162-hospital-pays-ransomware-but-doesnt-get-files-decrypted">here</a>, <a href="http://thehackernews.com/2016/06/university-ransomware.html">here</a> and <a href="http://www.digitaltrends.com/computing/ransomware-hospital-hackers-demand-more-money/">here</a>&nbsp;). &nbsp;This situation has been made possible by users who paid the ransoms during the past months. Those users arose the Ransomware ecosystem reputation by increasing the trust of entire supply chain. &nbsp;</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">For example we experienced many infected users saying:</div><blockquote class="tr_bq">"Ok, I took a ransomware and my backup sucks. Let's pay the ransom, it only asks for few bucks. I'll pay more attention next time!"</blockquote><div style="text-align: justify;"><br /></div><div style="text-align: justify;">This user' behaviour increased the Ransomware reputation such as today nobody doubts about paying the ransom and getting back own files. This "well reputation" made possible for "not super skilled" attackers and/or to attackers who wanted to make quick money, to implement "half of the Ransomware (without decryption module)". This made very angry the whole Ransomware 's writer community (which happens to be a professional community) who actually is divided into two main parties: the one who wants to increase the Ransomware reputation by giving back files once the ransom has been payed (usually Ransomware as a service writers) and the one who exploits the Ransomware community reputation writing quick and dirty Ransomware (available on black market as a service as well) who actually wont give back files once the ransom has paid (usually single hosted Ransomware).</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Ok, nice story but how do we fight them ?</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Today there are two main known strategies so far:</div><div style="text-align: justify;"></div><ol><li>Try to block the ransomware infection before it "fires up".</li><li>Try to detect it before it can create a real "damage".</li></ol><div>I wont write about prevention on this "post" but just about mitigation. So I assume the Ransomware is already landed on the victim's machine.</div><div><b style="text-align: justify;"><br /></b></div><div><b style="text-align: justify;">Methods to try to block a Ransomware infection before it "fires up".</b></div><div><span style="text-align: justify;">Three main methods to try to block a Ransomware infection assuming the Malware already landed into victim's PC are implemented so far:</span></div><div><span style="text-align: justify;"><br /></span></div><div><span style="text-align: justify;">1. Signature Based (AV) Approach.&nbsp;</span></div><blockquote class="tr_bq"><span style="text-align: justify;">As common virus the known Ransomware own signatures. If the signature (that could be static ore dynamic) matches the sample file, the sample itself is blocked and trashed away.</span></blockquote>This is the romantic approach that will work only for known ransomware. Useless in today's technology.<br /><br />2. Policy Based Approach.<br /><blockquote class="tr_bq"><div style="text-align: justify;">Files executable could not be run from every folder (for example from the eMail folder or from temporary folders)</div></blockquote><div style="text-align: justify;">It could be a first and important way to "decelerate" the infection rate. In fact many infections happen through "avid clickers" who open untrusted email and/or click on untrusted links. Having them to move the "downloaded file" or to copy the malicious attachment to another destination often helps the "avid clickers" to get distracted and to not get infected.</div><br />3. CallBack Based approach.<br /><blockquote class="tr_bq">Every recent Ransomware needs to comunicate to external servers to get &nbsp;encryption key or to communicate the infection to the attacker and later on to get back the decryption key. A primitive approach is to detect the callback and to block it avoiding the initial communication.</blockquote><div><span style="text-align: justify;">This approach is hard in the real life since the communication methods can be very brilliant and innovative. Indeed the communication to command and control could be (just for example) end-to-end encrypted</span><b style="text-align: justify;">&nbsp;</b><span style="text-align: justify;">and/</span><span style="text-align: justify;">or the contacting addresses could be a legitimate hacked domain.</span></div><div><b style="text-align: justify;"><br /></b></div><div style="text-align: justify;"><b>Methods to try to detect it before it can create a real "damage"</b></div><div style="text-align: justify;">Some of the main methods implemented by commercial products try to block the Ransomware Infection once it has been fired up. Following the most implemented strategies.&nbsp;</div><div style="text-align: justify;"><br /></div><div><div style="text-align: justify;">1. Flag processes who read and write too many files too quickly.&nbsp;</div><blockquote class="tr_bq" style="text-align: justify;">This method, is used by <a href="https://blog.malwarebytes.com/malwarebytes-news/2016/01/introducing-the-malwarebytes-anti-ransomware-beta/">MalwareBytes AntiRansomware</a>&nbsp;which is based on Nathan Scott's <a href="http://www.bleepingcomputer.com/forums/t/572146/cryptomonitor-stop-all-known-crypto-ransomware-before-it-encrypts-your-data/">CryptoMonitor</a>.&nbsp;<span style="text-align: left;">It counts how often untrusted processed have modified “a certain number of personal files, under a certain time.” A similar method&nbsp;implemented by Adam&nbsp;Kramer’s&nbsp;</span><a href="https://digital-forensics.sans.org/blog/2015/04/03/identifying-and-disrupting-crypto-ransomware-and-destructive-malware" style="text-align: left;">hande_monitor</a><span style="text-align: left;">&nbsp;tool on the frequency with which processes create handles through which they&nbsp;can access files.</span></blockquote><div style="text-align: justify;">Implementing this method solo could have a tons of false positives (and white/black listing on them). Let's image DropBox process or GoogleDrive during a sync phase. How many file does it modify/delete/create and how quickly does it ? Or CAD software who constantly saves tons of partial rendered piece of files before assembling them ? It's clear that this strategy solo is not gonna work.</div><div style="text-align: justify;">&nbsp; &nbsp;&nbsp;</div><div style="text-align: justify;">2. Flag processes that changes file's entropy values.</div><blockquote class="tr_bq" style="text-align: justify;">Encrypted files tend to have a more uniform distribution of byte values than other files. Their contents are&nbsp;more uniform. Our tool could compare the file’s entropy before and&nbsp;after the change. If a modified file has higher entropy, it might have gotten&nbsp;encrypted, indicating that the&nbsp;responsible process might&nbsp;be ransomware.&nbsp;</blockquote></div><div style="text-align: justify;">Implementing this method solo you might find issues on real encrypted files and/or on compressed files who tend to have a while flat ad uniform distribution of charset.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">3. Flag processes who change entropy of selected "untouchable" files.</div><blockquote class="tr_bq" style="text-align: justify;">Specific canary files are dynamically injected into hidden or not hidden folders and monitored. If a process tries to modify them, the process will be considered as malicious.</blockquote><div style="text-align: justify;">Implementing this method solo could generate false positives since an unsuspecting user could open the canary file at any time.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">4. SyncHoling folders.</div><blockquote class="tr_bq" style="text-align: justify;">By creating a nested tree of recursive folders to trap single processes Ransomware who will loop into it by consuming a lot of resources but without encrypting any real user file.</blockquote><div style="text-align: justify;">Once the process (Ransomware process) is identified by one or more techniques as expressed above the system could kill it or suspend it (putting it in holding mode) asking to user what to do.</div><div style="text-align: justify;"><br /><br /></div><div style="text-align: justify;"><b>Conclusions</b></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Ransomware infections are one of the most spread threats in todays' Internet (foreground internet). They have been evolved over years (a super great paper on the Ransomware evolution could be found <a href="http://seclab.ccs.neu.edu/static/publications/dimva2015ransomware.pdf">here</a>) since the last evolution defined <b>Ransomworm</b> (conied at the beginning of 2016), which includes self propagating skills, such as for example: infecting public accessible folders and/or running vulnerability scanning on network machine for known exploitable vulnerabilities which will be used in order to propagate itself. The following image shows the activity of used bitcoin address in a Ransomware campaign. As you might observe the average time frame of a Bitcoin address used in a Ransomware fraud is between 0 to 5 days which makes super hard to catch the owner by cross-correlation over multiple transitions.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-_zABoOzKYUI/V548fBjKTAI/AAAAAAAANFs/X2ZKY_Kfs84clU5TIwc7_Ipik4PDFybHgCLcB/s1600/Screen%2BShot%2B2016-07-31%2Bat%2B19.58.42.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="217" src="https://4.bp.blogspot.com/-_zABoOzKYUI/V548fBjKTAI/AAAAAAAANFs/X2ZKY_Kfs84clU5TIwc7_Ipik4PDFybHgCLcB/s320/Screen%2BShot%2B2016-07-31%2Bat%2B19.58.42.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Figure 1: The duration of activity for Bitcoin addresses. Approximately 50% of Bitcoin addresses have zero to five days of active life (from <a href="http://seclab.ccs.neu.edu/static/publications/dimva2015ransomware.pdf">here</a>).</td></tr></tbody></table><br /><br /><br />Nowadays there are plenty quick fixes that promise to solve the issue but not a real solver has been released to public (at least as far as I know) so far. At this point I wont give you the consolidated suggestion to keep up to date your OS and to download the last AntiVirus Engine because it really do not matter at all. Apply the policies, inform your users about this threat and stay tuned, the answer to such a threat will come and something will happen in the Anti Malware market soon :) &nbsp;.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Fighting%20Ransomware%20Threats%20-http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f&title=Fighting%20Ransomware%20Threats%20" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffighting-ransomware-threats%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
