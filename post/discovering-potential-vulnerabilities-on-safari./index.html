<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Discovering Potential Vulnerabilities on Safari. &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Feb 10, 2008</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 400 words 2 min. read
        </div>
        <h1>Discovering Potential Vulnerabilities on Safari.</h1>
        <section id="post-content" class="article-content post">
          <div style="text-align: justify;">Hi folks, this morning following the example of <a href="http://en.wikipedia.org/wiki/Phishing">an old way to phishing browsers</a>, (under link manipulation) I've found a Safari leak. Let me try, before, with an easy example of unaware link redirection and then we'll try to discuss how this bug becomes vulnerability. <br /></div><div style="text-align: justify;">Well, our main target is to grab accesses to bank account (?), gmail (?), whatever you want. The first step, as usually, is building a clone page of our target with a malicious code inside. Second step, redirect people on this malicious site. The technique is always the same:</div><div><div style="text-align: justify;"><br /></div><blockquote><div style="text-align: justify;"><br /></div><div style="text-align: justify;">http://username:url@phisdomain<br /></div></blockquote><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Here the exact example on last safari browser:<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="color: rgb(0, 0, 238); "><img src="http://content.screencast.com/media/46fd1789-2c7a-45a0-9cc9-1c8052aa880f_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000008.png" width="866" height="391" border="0" /></span><a href="http://content.screencast.com/media/46fd1789-2c7a-45a0-9cc9-1c8052aa880f_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000008.png"><br /></a></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">As you see in the next figure, safari opened the page marcoramilli.blogspot.com asking nothing, no warnings and no exceptions (marcoramilli.blogspot.com doesn't ask username !) Safari opened it and nothing more.<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="color: rgb(0, 0, 238); "><img src="http://content.screencast.com/media/e0b8a164-1fd1-4b1e-8130-44cd5f0f36c2_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000004.png" width="866" height="391" border="0" /></span><a href="http://content.screencast.com/media/e0b8a164-1fd1-4b1e-8130-44cd5f0f36c2_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000004.png"><br /></a></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Right now, it could seem quite normal, maybe you're thinking "I can see the URI bar, so I know where I am !". Well actually, I'm not so sure that every people look inside the html code in order to verify if the link points to the exact webpage, but there's more! Just adjusting the link on the URI bar, adding some spaces and eliminating the username side, the URI will appear clear and impossible to detect by human. Let's look it ! The following image represents the phished URL before be submitted, as you can see human eyes cant figure out the difference between this URL and the original one<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="color: rgb(0, 0, 238); "><img src="http://content.screencast.com/media/c4603781-0898-4c98-a786-b184c8dac1b2_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000005.png" width="866" height="391" border="0" /></span><a href="http://content.screencast.com/media/c4603781-0898-4c98-a786-b184c8dac1b2_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000005.png"><br /></a></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">After the submission:<br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="color: rgb(0, 0, 238); "><img src="http://content.screencast.com/media/fb1a2fdc-761a-48fb-b5a0-9b17624f05fd_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000006.png" width="865" height="391" border="0" /></span><a href="http://content.screencast.com/media/fb1a2fdc-761a-48fb-b5a0-9b17624f05fd_aa65a76c-fff6-4e10-b662-ceba8e05d445_static_0_0_00000006.png"><br /></a></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Of course, now you'll se the spaces (%20) but the URL has just been submitted. That means you are redirected on malicious website. Now, it might be clear why this is a real problem. If inside the malicious site has encoded an easy javascript able to grab your gmail cookies or whatever, you've just lost your credentials. <br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-weight: bold;">UPDATE:</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">The apple security team contacted me, they're very very extremely fast and nice. :P</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><a href="http://www.sdsc.edu/~peisert/">Sean Peisert</a>, asked me: " What about iPhone ?". That's true !! iPhone got Safari too and it's very common to use iPhone having access to bank accounts.... Anyway, the answer was, Yep..iPhone is vulnerable too.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Discovering%20Potential%20Vulnerabilities%20on%20Safari.-http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f&title=Discovering%20Potential%20Vulnerabilities%20on%20Safari." target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fdiscovering-potential-vulnerabilities-on-safari.%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
