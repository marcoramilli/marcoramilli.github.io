<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Facebook Security: Malware Analysis &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Dec 20, 2010</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          â€¢ 1900 words 9 min. read
        </div>
        <h1>Facebook Security: Malware Analysis</h1>
        <section id="post-content" class="article-content post">
          <p><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Thanks to <a href="http://cesena.ing2.unibo.it/">CeSeNA group</a> and to Luca Mella (one of the organizers of CeSeNA), I found out a nice example (in terms of &hellip;  &ldquo;a didactical one&rdquo; ) of Malware (keylogger) which explains how attackers might use social networks to spread new generation of Malware.</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Everything starts from a friend who sends to you a link. In the specific case the link was: <a href="http://www.facebook.com/l.php?u=www.acoplasticos.org%2Fcrm">http://www.facebook.com/l.php?u=www.acoplasticos.org%2Fcrm</a>. Opening the link a nice trap asks to click on a &ldquo;button&rdquo; which executes a fake image. (An executable file) called: <span style="font-style:italic;">image96523489.exe</span> .</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">If the attacked user clicks on it, it executes 2 processes: The current Browser (in a safe mode) and a backgrounded program called <span style="font-style:italic;">vnsvc32.exe</span>, which is the actual real Malware.</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">The first action performed by vnsvc32.exe is to copy itself and other two files on the &ldquo;private win&rdquo; folders: C:\windows\nvsvc32.exe, C:\windows\wibrf.jpg and C:\windows\wiybr.png. </span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">It adds AutoStart registry&rsquo;s entries in: <span style="font style:italic;">machine\software\microsoft\Windows\CurrentVersion\Run\NVIDIA driver monitor = c:\windows\nvsvc32.exe</span>, in <span style="font-style:italic;">machine\software\microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run\NVIDIA driver monitor = c:\windows\nvsvc32.exe</span>, in <span style="font-style:italic;">machine\system\CurrentControlSet\Services\wuauserv\Start = 04000000</span> and in other secondary location.</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">It changes internet explorer entries such as: <span style="font-style:italic;">software\microsoft\internet explorer\main</span>, <span style="font-style:italic;">user\current\software\Microsoft\Internet Explorer\Toolbar\Locked = 01000000</span> and <span style="font-style:italic;">user\current\software\Microsoft\Windows\CurrentVersion\Run\NVIDIA driver monitor = c:\windows\nvsvc32.exe</span>.</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Some DNS queries:</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: astro.ic.ac.uk</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: ale.pakibili.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: versatek.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: journalofaccountancy.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: transnationale.org</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: browseusers.myspace.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: mas.0730ip.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: www.myspace.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: ds.phoenix-cc.net</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: stayontime.info</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: www.shearman.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: insidehighered.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: ate.lacoctelera.net</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: websitetrafficspy.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: qun.51.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: x.myspacecdn.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: www.facebook.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: summer-uni-sw.eesp.ch</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: shopstyle.com</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: xxx.stopklatka.pl</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Query DNS: xxx.stopklatka.pl.localdomain</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">And of course  internet connections.</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;63.135.80.224&rdquo; on port 80 (TCP - HTTP).</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;63.135.80.46&rdquo; on port 80 (TCP - HTTP).</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;46.40.191.11&rdquo; on port 80 (TCP - HTTP).</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;66.220.158.18&rdquo; on port 80 (TCP - HTTP).</span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;174.37.200.82&rdquo; on port 80 (TCP - HTTP).</span></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">From those address the Malware downloads the actual core of the malware (also known as payload) coping it over different processes and folders on the attacked machine. But this is not really interesting.</span></div><br /><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Connects to &ldquo;205.234.253.15&rdquo; on port 1234 (TCP). </span></div><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">This action seems to be much more interesting. By opening-it, using a normal web browser we see t non &ldquo;over HTTP&rdquo; communication.</span></div><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_gK7b9huwiwY/TQ8gMl9joiI/AAAAAAAAKjM/0oj7yD1g8Hw/s1600/ppp.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 126px;" src="http://3.bp.blogspot.com/_gK7b9huwiwY/TQ8gMl9joiI/AAAAAAAAKjM/0oj7yD1g8Hw/s400/ppp.png" border="0" alt="" id="BLOGGER_PHOTO_ID_5552692266291929634" /></a><br /><br /><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Analyzing the communication layer and querying the DNS authority, it comes out the used communication protocol: <span style="font-weight:bold;">FTP</span>.</span></div><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_gK7b9huwiwY/TQ8jl1zcU2I/AAAAAAAAKjU/dSmscSJjfLE/s1600/ftp.png"><img style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 400px; height: 226px;" src="http://1.bp.blogspot.com/_gK7b9huwiwY/TQ8jl1zcU2I/AAAAAAAAKjU/dSmscSJjfLE/s400/ftp.png" border="0" alt="" id="BLOGGER_PHOTO_ID_5552695998576087906" /></a><br /><br /><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">The use of an FTP is often related to a keylogger activity. First it injects DLLs into processes and then it uploads the stored passwd and/or cookies into the FTP. In fact it injects <span style="font-style:italic;">C:\windows\ndl.dll</span> into several programs including Explorer, Office, Outlook, etc. It injects cookies: <span style="font-style:italic;">C:\Documents and Settings\Administrator\Cookies\administrator@facebook[1].txt</span>, <span style="font-style:italic;">C:\Documents and Settings\Administrator\Cookies\administrator@myspace[2].txt</span>, and <span style="font-style:italic;">C:\Documents and Settings\Administrator\Cookies\administrator@www.myspace[1].txt</span> and it creates new system services. Every 10 minutes it uploads a file colled <em>session</em>.txt to the FTP server.</span></div><br /><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; font-weight: bold; ">This is a classic example of how social medias could be used to spread Malware. First the attacker asks your friendship &hellip; most of the time if a nice girl or a good looking man that you probably might have known in some places, but  you do not remember at all, asks your friendship you give it. Probably for kindness or to be sure to don&rsquo;t be an ass hole. Second, after the attacker is in your friendship community he waits some time just to mitigate the friendship. After time he sends to you a link, by creating a private message or posting on your wall or just adding a news feed. You do not remember who is him but since he&rsquo;s in your friendship area you trust him. Here comes the real trick. You didn&rsquo;t remember him when he asked your friendship, and probably if immediately after his request he would sent to you a link you probably did not trust him. But after some time you forgot that you didn&rsquo;t trust him. So you trust him because you assume that who is in your friendship network is a friend and for such a reason trusted. You open the link and you become infected.</span></div><br /><div style="text-align: justify;"><span class="Apple-style-span" style="font-size: 16.2037px; ">Yes, keylogging activity is complicated. You need to hack several websites in order to upload the payload and the malware, you need to hack an FTP server, you need to write a good payload that antivirus don&rsquo;t detect, you need to force and to spread everything around the world.. I mean it&rsquo;s a job ! But all the technology falls down if compared to social engineering techniques. Most of the time Social Engineering is the most powerful attacker&rsquo;s weapon. Protecting from it means protecting from most of the complicated and mad attacking technology.</span></div><br /><br />Following a detailed report on the Malware:<br /><br /> [ General information ]<br />   * File name: c:\documents and settings\administrator\desktop\image96523489.exe<br />   * File length: 65024 bytes<br />   * File signature: Microsoft Visual C++ 7.0<br />   * MD5 hash: 085ecb8b600c3b4b105674ed27cdcbaf<br />   * SHA1 hash: 5c20fe20a5f0a86d1b0455f8d20299dfe583b30b<br />   * SHA256 hash: f2a17d30d9e921fdc9e0d7f927f20c8820869552d8ba1cfa5f7fbc68d64f970a<br /><br /> [ Changes to filesystem ]<br />   * Creates file C:\windows\ndl.dl<br />   * Creates file (hidden) C:\windows\nvsvc32.exe<br />   * Creates file (hidden) C:\windows\wibrf.jpg<br />   * Creates file (hidden) C:\windows\wiybr.png<br />   * Creates file C:\Documents and Settings\Administrator\Cookies\administrator@facebook[1].txt<br />   * Creates file C:\Documents and Settings\Administrator\Cookies\administrator@myspace[2].txt<br />   * Creates file C:\Documents and Settings\Administrator\Cookies\administrator@www.myspace[1].txt<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\History\History.IE5\MSHist012010121320101220\index.dat<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\History\History.IE5\MSHist012010122020101221\index.dat<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\F7YBJYVW\bg_browserSection[1].jpg<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\F7YBJYVW\browserunsupported[1].htm<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\JRQBGGX3\icon_information[1].gif<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\JRQBGGX3\index[4].htm<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\LPI195Q5\bg_infobox[1].jpg<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\LPI195Q5\browserLogos_med[1].jpg<br />   * Creates file C:\Documents and Settings\Administrator\Local Settings\Temporary Internet Files\Content.IE5\ZQFMUB46\cornersSheet[1].png<br /><br /> [ Changes to registry ]<br />   * Creates value &ldquo;FileTracingMask=0000FFFF&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Tracing\FWCFG<br />   * Creates value &ldquo;ConsoleTracingMask=0000FFFF&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Tracing\FWCFG<br />   * Creates value &ldquo;MaxFileSize=00001000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Tracing\FWCFG<br />   * Creates value &ldquo;FileDirectory=2500770069006E0064006900720025005C00740072006100630069006E0067000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Tracing\FWCFG<br />   * Creates value &ldquo;NVIDIA driver monitor=c:\windows\nvsvc32.exe&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows\CurrentVersion\Run<br />   * Creates value &ldquo;NVIDIA driver monitor=c:\windows\nvsvc32.exe&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Terminal Server\Install\Software\Microsoft\Windows\CurrentVersion\Run<br />   * Creates value &ldquo;LogSessionName=7300740064006F00750074000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\NAP\Netsh<br />   * Creates value &ldquo;Active=01000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\NAP\Netsh<br />   * Creates value &ldquo;ControlFlags=01000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\NAP\Netsh<br />   * Creates value &ldquo;Guid=710adbf0-ce88-40b4-a50d-231ada6593f0&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\NAP\Netsh\Napmontr<br />   * Creates value &ldquo;BitNames= NAP_TRACE_BASE NAP_TRACE_NETSH&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\NAP\Netsh\Napmontr<br />   * Creates value &ldquo;LogSessionName=7300740064006F00750074000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\qagent<br />   * Creates value &ldquo;Active=01000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\qagent<br />   * Creates value &ldquo;ControlFlags=01000000&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\qagent<br />   * Creates value &ldquo;Guid=b0278a28-76f1-4e15-b1df-14b209a12613&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\qagent\traceIdentifier<br />   * Creates value &ldquo;BitNames= Error Unusual Info Debug&rdquo; in key HKEY_LOCAL_MACHINE\software\microsoft\Windows NT\CurrentVersion\Tracing\Microsoft\qagent\traceIdentifier<br />   * Creates Registry key HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\napagent\LocalConfig\Enroll\HcsGroups<br />   * Creates Registry key HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\napagent\LocalConfig\UI<br />   * Creates value &ldquo;image96523489.exe=c:\windows\nvsvc32.exe:*:Enabled:NVIDIA driver monitor&rdquo; in key HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List\C:\Documents and Settings\Administrator\Desktop<br />   * Modifies value &ldquo;Start=00000004&rdquo; in key HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\wuauserv<br />          old value &ldquo;Start=00000002&rdquo;<br />   * Modifies value &ldquo;Window_Placement=2C0000000000000001000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF62000000920000005903000041030000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Internet Explorer\Main<br />          old value &ldquo;Window_Placement=2C0000000000000001000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA00000000000000097030000AF020000&rdquo;<br />   * Deletes Registry key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2\CPC\Volume<br />   * Modifies value &ldquo;HRZR_PGYFRFFVBA=10015D0E14000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist{5E6AB780-7743-11CF-A12B-00AA004AE837}\Count<br />          old value &ldquo;HRZR_PGYFRFFVBA=FDED5C0E13000000&rdquo;<br />   * Modifies value &ldquo;Count=00000010&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Ext\Stats{E2E2DD38-D088-4134-82B7-F2BA38496583}\iexplore<br />          old value &ldquo;Count=0000000F&rdquo;<br />   * Modifies value &ldquo;Time=DA070C000100140008002A0022006C00&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Ext\Stats{E2E2DD38-D088-4134-82B7-F2BA38496583}\iexplore<br />          old value &ldquo;Time=DA070C0005001100070037003000A802&rdquo;<br />   * Modifies value &ldquo;Count=00000010&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Ext\Stats{FB5F1910-F110-11D2-BB9E-00C04F795683}\iexplore<br />          old value &ldquo;Count=0000000F&rdquo;<br />   * Modifies value &ldquo;Time=DA070C000100140008002A0022007C00&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Ext\Stats{FB5F1910-F110-11D2-BB9E-00C04F795683}\iexplore<br />          old value &ldquo;Time=DA070C0005001100070037003000A802&rdquo;<br />   * Creates value &ldquo;CachePath=25005500530045005200500052004F00460049004C00450025005C004C006F00630061006C002000530065007400740069006E00670073005C0048006900730074006F00720079005C0048006900730074006F00720079002E004900450035005C004D00530048006900730074003000310032003000310030003100320031003300320030003100300031003200320030005C000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121320101220<br />   * Creates value &ldquo;CachePrefix=:2010121320101220: &ldquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121320101220<br />   * Creates value &ldquo;CacheLimit=00200000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121320101220<br />   * Creates value &ldquo;CacheOptions=0B000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121320101220<br />   * Deletes Registry key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121420101215<br />   * Deletes Registry key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010121620101217<br />   * Creates value &ldquo;CachePath=25005500530045005200500052004F00460049004C00450025005C004C006F00630061006C002000530065007400740069006E00670073005C0048006900730074006F00720079005C0048006900730074006F00720079002E004900450035005C004D00530048006900730074003000310032003000310030003100320032003000320030003100300031003200320031005C000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010122020101221<br />   * Creates value &ldquo;CachePrefix=:2010122020101221: &ldquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010122020101221<br />   * Creates value &ldquo;CacheLimit=00200000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010122020101221<br />   * Creates value &ldquo;CacheOptions=0B000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\5.0\Cache\Extensible Cache\MSHist012010122020101221<br />   * Modifies value &ldquo;SavedLegacySettings=3C00000020000000010000000000000000000000000000000400000000000000A0C4FAAF62D0CA0101000000AC10268B0000000000000000&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Internet Settings\Connections<br />          old value &ldquo;SavedLegacySettings=3C0000001E000000010000000000000000000000000000000400000000000000A0C4FAAF62D0CA0101000000AC10268B0000000000000000&rdquo;<br />   * Creates value &ldquo;NVIDIA driver monitor=c:\windows\nvsvc32.exe&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\CurrentVersion\Run<br />   * Modifies value &ldquo;MRUListEx=02000000010000000800000016000000170000000F0000000D0000001500000014000000130000001200000010000000110000000300000000000000050000000E0000000C0000000B0000000A00000009000000070000000600000004000000FFFFFFFF&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\ShellNoRoam\BagMRU<br />          old value &ldquo;MRUListEx=01000000020000000800000016000000170000000F0000000D0000001500000014000000130000001200000010000000110000000300000000000000050000000E0000000C0000000B0000000A00000009000000070000000600000004000000FFFFFFFF&rdquo;<br />   * Modifies value &ldquo;WinPos1286x734(1).left=00000062&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell<br />          old value &ldquo;WinPos1286x734(1).left=000000A0&rdquo;<br />   * Modifies value &ldquo;WinPos1286x734(1).top=00000092&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell<br />          old value empty<br />   * Modifies value &ldquo;WinPos1286x734(1).right=00000359&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell<br />          old value &ldquo;WinPos1286x734(1).right=00000397&rdquo;<br />   * Modifies value &ldquo;WinPos1286x734(1).bottom=00000341&rdquo; in key HKEY_CURRENT_USER\software\Microsoft\Windows\ShellNoRoam\Bags\8\Shell<br />          old value &ldquo;WinPos1286x734(1).bottom=000002AF&rdquo;<br />   * Deletes Registry key HKEY_CURRENT_USER\software\classes*\shell\sandbox<br /><br /> [ Network services ]<br />   * Looks for an Internet connection.<br />   * Backdoor functionality on port 0.<br />   * Queries DNS astro.ic.ac.uk<br />   * Queries DNS ale.pakibili.com<br />   * Queries DNS versatek.com<br />   * Queries DNS journalofaccountancy.com<br />   * Queries DNS transnationale.org<br />   * Queries DNS browseusers.myspace.com<br />   * Queries DNS mas.0730ip.com<br />   * Queries DNS www.myspace.com<br />   * Queries DNS ds.phoenix-cc.net<br />   * Queries DNS stayontime.info<br />   * Queries DNS www.shearman.com<br />   * Queries DNS insidehighered.com<br />   * Queries DNS ate.lacoctelera.net<br />   * Queries DNS websitetrafficspy.com<br />   * Queries DNS qun.51.com<br />   * Queries DNS x.myspacecdn.com<br />   * Queries DNS www.facebook.com<br />   * Queries DNS summer-uni-sw.eesp.ch<br />   * Queries DNS shopstyle.com<br />   * Queries DNS xxx.stopklatka.pl<br />   * Queries DNS xxx.stopklatka.pl.localdomain<br />   * Connects to &ldquo;63.135.80.224&rdquo; on port 80 (TCP - HTTP).<br />   * Connects to &ldquo;63.135.80.46&rdquo; on port 80 (TCP - HTTP).<br />   * Connects to &ldquo;205.234.253.15&rdquo; on port 1234 (TCP).<br />   * Connects to &ldquo;46.40.191.11&rdquo; on port 80 (TCP - HTTP).<br />   * Connects to &ldquo;66.220.158.18&rdquo; on port 80 (TCP - HTTP).<br />   * Connects to &ldquo;174.37.200.82&rdquo; on port 80 (TCP - HTTP).<br />   * Opens next URLs:<br />     <a href="http://174.37.200.82/index.php">http://174.37.200.82/index.php</a><br /><br /> [ Process/window information ]<br />   * Keylogger functionality.<br />   * Creates process &ldquo;(null),net stop  ,(null)&rdquo;.<br />   * Injects code into process &ldquo;net.exe&rdquo;.<br />   * Creates a mutex &ldquo;SHIMLIB_LOG<em>MUTEX&rdquo;.<br />   * Creates an event named &ldquo;DINPUTWINMM&rdquo;.<br />   * Creates an event named &ldquo;Global\userenv:  User Profile setup event&rdquo;.<br />   * Creates process &ldquo;(null),net1 stop  ,(null)&rdquo;.<br />   * Injects code into process &ldquo;net1.exe&rdquo;.<br />   * Creates process &ldquo;(null),C:\Documents and Settings\Administrator\Desktop\image96523489.exe,(null)&ldquo;.<br />   * Injects code into process &ldquo;image96523489.exe&rdquo;.<br />   * Creates an event named &ldquo;Global\crypt32LogoffEvent&rdquo;.<br />   * Creates a mutex &ldquo;Nvidia Drive Mon&rdquo;.<br />   * Creates a mutex &ldquo;</em>!MSFTHISTORY!<em>&rdquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!temporary internet files!content.ie5!&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!cookies!&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!history!history.ie5!&ldquo;.<br />   * Creates process &ldquo;(null),netsh firewall add allowedprogram 1.exe 1 ENABLE,(null)&rdquo;.<br />   * Creates process &ldquo;c:\windows\nvsvc32.exe,(null),c:\windows&rdquo;.<br />   * Creates process &ldquo;(null),explorer.exe <a href="http://browseusers.myspace.com/Browse/Browse.aspx,(null)&quot;">http://browseusers.myspace.com/Browse/Browse.aspx,(null)&quot;</a>.<br />   * Injects code into process &ldquo;explorer.exe&rdquo;.<br />   * Opens a service named &ldquo;ShellHWDetection&rdquo;.<br />   * Creates process &ldquo;(null),C:\windows\nvsvc32.exe,(null)&ldquo;.<br />   * Injects code into process &ldquo;nvsvc32.exe&rdquo;.<br />   * Injects code into process &ldquo;iexplore.exe&rdquo;.<br />   * Creates a mutex &ldquo;Shell.CMruPidlList&rdquo;.<br />   * Creates process &ldquo;(null),net stop wuauserv,(null)&rdquo;.<br />   * Creates a mutex &ldquo;RasPbFile&rdquo;.<br />   * Creates a mutex &ldquo;ZonesCounterMutex&rdquo;.<br />   * Creates a mutex &ldquo;ZonesCacheCounterMutex&rdquo;.<br />   * Creates a mutex &ldquo;ZonesLockedCacheCounterMutex&rdquo;.<br />   * Creates a mutex &ldquo;oleacc-msaa-loaded&rdquo;.<br />   * Creates process &ldquo;(null),net stop MsMpSvc,(null)&rdquo;.<br />   * Enumerates running processes.<br />   * Creates process &ldquo;(null),sc config wuauserv start= disabled,(null)&rdquo;.<br />   * Opens a service named &ldquo;RASMAN&rdquo;.<br />   * Creates process &ldquo;(null),sc config MsMpSvc start= disabled,(null)&rdquo;.<br />   * Injects code into process &ldquo;sc.exe&rdquo;.<br />   * Creates process &ldquo;(null),net1 stop wuauserv,(null)&rdquo;.<br />   * Creates process &ldquo;(null),net1 stop MsMpSvc,(null)&rdquo;.<br />   * Opens a service named &ldquo;wuauserv&rdquo;.<br />   * Opens a service named &ldquo;MsMpSvc&rdquo;.<br />   * Lists all entry names in a remote access phone book.<br />   * Injects code into process &ldquo;netsh.exe&rdquo;.<br />   * Creates a mutex &ldquo;CTF.LBES.MutexDefaultS-1-5-21-1078081533-1677128483-1801674531-500&rdquo;.<br />   * Creates a mutex &ldquo;CTF.Compart.MutexDefaultS-1-5-21-1078081533-1677128483-1801674531-500&rdquo;.<br />   * Creates a mutex &ldquo;CTF.Asm.MutexDefaultS-1-5-21-1078081533-1677128483-1801674531-500&rdquo;.<br />   * Creates a mutex &ldquo;CTF.Layouts.MutexDefaultS-1-5-21-1078081533-1677128483-1801674531-500&rdquo;.<br />   * Creates a mutex &ldquo;CTF.TMD.MutexDefaultS-1-5-21-1078081533-1677128483-1801674531-500&rdquo;.<br />   * Opens a service named &ldquo;NapAgent&rdquo;.<br />   * Creates a mutex &ldquo;</em>!SHMSFTHISTORY!_&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!history!history.ie5!mshist012010121420101215!&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!history!history.ie5!mshist012010121320101220!&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!history!history.ie5!mshist012010121620101217!&ldquo;.<br />   * Creates a mutex &ldquo;c:!documents and settings!administrator!local settings!history!history.ie5!mshist012010122020101221!&ldquo;.<br />   * Creates a mutex &ldquo;HGFSMUTEX&rdquo;.<br />   * Opens a service named &ldquo;WebClient&rdquo;.<br />   * Creates a mutex &ldquo;Global\winlogon: Logon UserProfileMapping Mutex&rdquo;.<br />   * Creates a mutex &ldquo;_SHuassist.mtx&rdquo;.<br />   * Opens a service named &ldquo;AudioSrv&rdquo;.<br />   * Creates a mutex &ldquo;MidiMapper_modLongMessage_RefCnt&rdquo;.<br />   * Creates a mutex &ldquo;MidiMapper_Configure&rdquo;.</p>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Facebook%20Security%3a%20Malware%20Analysis-http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f&title=Facebook%20Security%3a%20Malware%20Analysis" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2ffacebook-security-malware-analysis%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
