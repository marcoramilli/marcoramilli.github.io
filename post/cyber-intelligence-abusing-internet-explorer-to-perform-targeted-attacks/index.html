<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Cyber Intelligence abusing Internet Explorer to perform Targeted Attacks &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Jul 27, 2014</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          â€¢ 700 words 3 min. read
        </div>
        <h1>Cyber Intelligence abusing Internet Explorer to perform Targeted Attacks</h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">A "mandatory" step to achieve a complete and successful targeted attack is the so called: "Cyber Intelligence Phase". By definition every targeted attack owns at leeast one specific characteristic which makes it perfectly fit for a given target. As you might want agree, one of the most important activities on develping a targeted attack is to exactly know what's running on the target system. The activity which takes care of "discovering" what's running on a given system is often called Cyber Intelligence (many of you on the Cyber Intelligence field might know a little bit different definition... but this is not the point). I wont write, in this quick and dirty blog post,&nbsp; about cyber intelligence, indeed I want to point you out simple techniques to perform a target enumeration by using Internet Explorer.&nbsp;</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">One of the most used techniques to perform Cyber Intelligence through Iinternet Explorer (IE) is the <b>"abusing of resources" (res://)</b> calls. This techniques afflicts IE from 6. to 8. It has been widely discussed in many online sites (for example: <a href="http://www.scip.ch/en/?vuldb.977" target="_blank">here</a>, <a href="http://julien.palard.fr/0x000000/articles/Internet_Explorer_8_ieframe_Vulnerabilities..html" target="_blank">here</a>, <a href="http://www.reddit.com/r/Enhancement/comments/tj5gs/i_managed_to_get_res_sort_of_running_in_ie9_may/" target="_blank">here</a> and <a href="http://smallbusiness.chron.com/fix-internet-explorer-resolution-56088.html" target="_blank">here</a>). The technique is based on the assumption that IE blocks access to local file system trhough the "file://" call, but let the "res://" call to have access to image resources on file system. To exploit this IE's behavior the attacker might look at specific executables holding (as resource)&nbsp; specific images. The res abuse://&nbsp; has been used as Cyber Intelligent Weapon in serveral attacks including the "waterhole campagin afffecting a Thailand NGO" as posted <a href="http://www.alienvault.com/open-threat-exchange/blog/thailand-ngo-site-hacked-and-serving-malware" target="_blank">here</a>. The aforementioned behavior could be exploited as follows:</div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-1En7uDbTKu4/U9No-Ct-EGI/AAAAAAAAL0g/sMJ6lobjdow/s1600/Screen+Shot+2014-07-26+at+10.37.13.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-1En7uDbTKu4/U9No-Ct-EGI/AAAAAAAAL0g/sMJ6lobjdow/s1600/Screen+Shot+2014-07-26+at+10.37.13.png" height="251" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From <a href="http://www.alienvault.com/open-threat-exchange/blog/attackers-abusing-internet-explorer-to-enumerate-software-and-detect-securi" target="_blank">AlienVault Article</a></td></tr></tbody></table>The <i>resList</i> contains the list of executables files used to detect AntiVirus Software. Following a simple example taken from a real case. A similar code was found into Skipot too...<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-LeJ-fPDfzrE/U9NqIaL0e6I/AAAAAAAAL0o/A_fCsJOr0zk/s1600/Screen+Shot+2014-07-26+at+10.42.43.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-LeJ-fPDfzrE/U9NqIaL0e6I/AAAAAAAAL0o/A_fCsJOr0zk/s1600/Screen+Shot+2014-07-26+at+10.42.43.png" height="78" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From <a href="http://www.alienvault.com/open-threat-exchange/blog/attackers-abusing-internet-explorer-to-enumerate-software-and-detect-securi" target="_blank">AlienVault Article</a></td></tr></tbody></table><div style="text-align: justify;">Another used technique to map software into a target host sees its implementation through the Microsoft <b>XMLDOM ActiveX Info disclosure vulnerability</b>. This vulnerability has been videly discussed as well (<a href="http://www.kb.cert.org/vuls/id/539289" target="_blank">here</a>, <a href="http://www.securityfocus.com/bid/65601/info" target="_blank">here, </a>and <a href="http://www.websecuritywatch.com/xml-injection-and-information-disclosure-vulnerability-in-microsoft-windows-8-1-xmldom-activex-control/" target="_blank">here</a>). Basically Microsoft.XMLDOM is an ActiveX control that can run in Internet Explorer without requiring any prompting to the user. This object contains methods that can leak information about a computer system to the operator of a website. By looking at error codes provided by the XMLDOM ActiveX control, an attacker can check for the presence of local drive letters, directory names, files, as well as internal network addresses or websites. It is confirmed that this issue affects Internet Explorer versions 6 through 11 running on Microsoft Windows through version 8.1. The following code shows an example of the implementation of such a vulnerability. It looks for the presence of specific files into the target system.</div><div style="text-align: justify;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-7OxIcbtzsnA/U9Nstt8tHsI/AAAAAAAAL00/3xZzxkZON6I/s1600/Screen+Shot+2014-07-26+at+10.53.49.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-7OxIcbtzsnA/U9Nstt8tHsI/AAAAAAAAL00/3xZzxkZON6I/s1600/Screen+Shot+2014-07-26+at+10.53.49.png" height="400" width="390" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Implementation of XMLDOM ActiveX vulns</td></tr></tbody></table><div style="text-align: justify;">&nbsp;Following on this way attackers might use more XMLDOM vulnerabilities such as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0322" target="_blank">CVE-2014-0322</a> in which Microsoft Internet Explorer 9 and 10 allows remote attackers to execute arbitrary code via vectors involving crafted JavaScript code, CMarkup, and the "onpropertychange" attribute of a script element, as exploited in the wild in January and February 2014. <a href="http://www.exploit-db.com/exploits/32904/" target="_blank">MSF exploits are available out there</a>. As WebSense discussed on his <a href="http://community.websense.com/blogs/securitylabs/archive/2014/02/14/msie-0-day-exploit-cve-2014-0322-possibly-targeting-french-aerospace-organization.aspx" target="_blank">Security Blog Post</a> attackers used the described technique to identify the Microsoft EMET presence on the target system. The same technique was found into Angler Exploit Kit and later on Goon and Cool Exploit Kits too.<br /><br />Cyber Intelligence, is one of the most fascinating field. It does nothing bad per se, it simply offers detailed infos to next "phases". As always happens such infos could be used by legitim systems as well as by attacker' systems. As you problably have learned in the past years... whatch out what you browse&nbsp; !<br /><br /><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=Cyber%20Intelligence%20abusing%20Internet%20Explorer%20to%20perform%20Targeted%20Attacks-http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f&title=Cyber%20Intelligence%20abusing%20Internet%20Explorer%20to%20perform%20Targeted%20Attacks" target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fcyber-intelligence-abusing-internet-explorer-to-perform-targeted-attacks%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
